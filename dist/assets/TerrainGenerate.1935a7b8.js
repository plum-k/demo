import{r as d,q as b,p as P,j as l,t as R,u as T,a as k,aF as q,c as A}from"./index.0d8aed65.js";import{u as C,H as F}from"./useProgress.017028ce.js";function G(){const{active:f,progress:h,errors:s,item:n,loaded:p,total:c}=C();return b(F,{center:!0,children:[h," % loaded"]})}const H=f=>{const{roughness:h}=f,s=Math.pow(2,f.detail)+1,n=s-1,p=new Float32Array(s*s),c=(t,r)=>t<0||t>n||r<0||r>n?-1:p[t+s*r],u=(t,r,e)=>{p[t+s*r]=e},g=t=>{var r=t.filter(a=>a!==-1),e=r.reduce((a,o)=>a+o,0);return e/r.length},w=(t,r,e,a)=>{var o=g([c(t-e,r-e),c(t+e,r-e),c(t+e,r+e),c(t-e,r+e)]);u(t,r,o+a)},j=(t,r,e,a)=>{var o=g([c(t,r-e),c(t+e,r),c(t,r+e),c(t-e,r)]);u(t,r,o+a)},_=()=>{u(0,0,n),u(n,0,n/2),u(n,n,0),u(0,n,n/2),v(n)},v=t=>{let r,e,a=t/2;const o=h*t;if(!(a<1)){for(e=a;e<n;e+=t)for(r=a;r<n;r+=t)w(r,e,a,Math.random()*o*2-o);for(e=0;e<=n;e+=a)for(r=(e+a)%t;r<=n;r+=t)j(r,e,a,Math.random()*o*2-o);v(t/2)}},x=()=>{_();const t=new k(512,512,s-1,s-1),r=t.getAttribute("position");for(let o=0;o<s;o++)for(let i=0;i<s;i++){let m=c(i,o);m<0&&(m=0),(o===0||o===s-1||i===0||i===s-1)&&(m=0),r.setZ(o*s+i,m)}t.computeVertexNormals();const e=new q,a=new A(t,e);return a.rotation.x=-Math.PI/2,a},M=T(t=>t.camera);return d.exports.useEffect(()=>{M.position.y=100,M.position.z=600}),l("primitive",{object:x()})},E=()=>{d.exports.useRef(),d.exports.useRef();const f=d.exports.useRef(null);return b(P,{children:[l("ambientLight",{args:[13421772]}),l("color",{attach:"background",args:["#101010"]}),l(R,{ref:f}),l(d.exports.Suspense,{fallback:l(G,{}),children:l(H,{detail:8,roughness:.7})})]})};export{E as default};
