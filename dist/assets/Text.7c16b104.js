var Ot=Object.getOwnPropertySymbols;var ln=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable;var Lt=(u,i)=>{var T={};for(var v in u)ln.call(u,v)&&i.indexOf(v)<0&&(T[v]=u[v]);if(u!=null&&Ot)for(var v of Ot(u))i.indexOf(v)<0&&un.call(u,v)&&(T[v]=u[v]);return T};import{U as cn,H as hn,J as dn,K as vn,N as pn,d as gn,b as Jt,h as mn,V as st,T as yn,Q as Rt,c as ft,E as bn,C as vt,X as Ir,Y as It,Z as Un,a as ut,_ as _n,$ as Tn,i as Sn,a0 as wn,a1 as xn,a2 as kn,a3 as Fn,r as Je,u as Cn,a4 as Dn,a5 as An}from"./index.0d8aed65.js";function pt(){var u=0,i=[],T,v=0,r=0;function e(p,h){var y=pt();function d(){var b=u>0?p:h;if(U(b))try{var w=b(T);w===y&&_();var A=l(w);A?A.call(w,y.resolve,y.reject):y.resolve(w)}catch(x){y.reject(x)}else y[u>0?"resolve":"reject"](T)}return i.push(d),u&&n(),y}var o=c(function(p){r||t(1,p)}),a=c(function(p){r||t(-1,p)});function t(p,h){r++;var y=0;try{h===g&&_();var d=p>0&&l(h);d?d.call(h,c(function(b){y++,t(1,b)}),c(function(b){y++,t(-1,b)})):(u=p,T=h,n())}catch(b){!u&&!y&&t(-1,b)}}function n(){v||(setTimeout(s,0),v=1)}function s(){var p=i;v=0,i=[],p.forEach(f)}function f(p){p()}function l(p){var h=p&&(U(p)||typeof p=="object")&&p.then;return U(h)&&h}function c(p){var h=0;return function(){for(var y=[],d=arguments.length;d--;)y[d]=arguments[d];h++||p.apply(this,y)}}function _(){throw new TypeError("Chaining cycle detected")}var U=function(p){return typeof p=="function"},g={then:e,resolve:o,reject:a};return g}function Kt(){var u,i,T=new Promise(function(v,r){u=v,i=r});return{then:T.then.bind(T),resolve:u,reject:i}}pt.all=Kt.all=function(u){var i=0,T=[],v=ze();return u.length===0?v.resolve([]):u.forEach(function(r,e){var o=ze();o.resolve(r),o.then(function(a){i++,T[e]=a,i===u.length&&v.resolve(T)},v.reject)}),v};var ze=typeof Promise=="function"?Kt:pt;function En(){var u=Object.create(null);function i(r,e){var o=r.id,a=r.name,t=r.dependencies;t===void 0&&(t=[]);var n=r.init;n===void 0&&(n=function(){});var s=r.getTransferables;if(s===void 0&&(s=null),!u[o])try{t=t.map(function(l){return l&&l.isWorkerModule&&(i(l,function(c){if(c instanceof Error)throw c}),l=u[l.id].value),l}),n=v("<"+a+">.init",n),s&&(s=v("<"+a+">.getTransferables",s));var f=null;typeof n=="function"?f=n.apply(void 0,t):console.error("worker module init function failed to rehydrate"),u[o]={id:o,value:f,getTransferables:s},e(f)}catch(l){l&&l.noLog||console.error(l),e(l)}}function T(r,e){var o,a=r.id,t=r.args;(!u[a]||typeof u[a].value!="function")&&e(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var n=(o=u[a]).value.apply(o,t);n&&typeof n.then=="function"?n.then(s,function(f){return e(f instanceof Error?f:new Error(""+f))}):s(n)}catch(f){e(f)}function s(f){try{var l=u[a].getTransferables&&u[a].getTransferables(f);(!l||!Array.isArray(l)||!l.length)&&(l=void 0),e(f,l)}catch(c){console.error(c),e(c)}}}function v(r,e){var o=void 0;self.troikaDefine=function(t){return o=t};var a=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(t){console.error(t)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(r){var e=r.data,o=e.messageId,a=e.action,t=e.data;try{a==="registerModule"&&i(t,function(n){n instanceof Error?postMessage({messageId:o,success:!1,error:n.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof n=="function"}})}),a==="callModule"&&T(t,function(n,s){n instanceof Error?postMessage({messageId:o,success:!1,error:n.message}):postMessage({messageId:o,success:!0,result:n},s||void 0)})}catch(n){postMessage({messageId:o,success:!1,error:n.stack})}})}function Mn(u){var i=function(){for(var T=[],v=arguments.length;v--;)T[v]=arguments[v];return i._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,T);throw new Error("Worker module function was called but `init` did not return a callable function")})};return i._getInitResult=function(){var T=u.dependencies,v=u.init;T=Array.isArray(T)?T.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[];var r=ze.all(T).then(function(e){return v.apply(null,e)});return i._getInitResult=function(){return r},r},i}var Qt=function(){var u=!1;if(typeof window!="undefined"&&typeof window.document!="undefined")try{var i=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));i.terminate(),u=!0}catch(T){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+T.message+"]")}return Qt=function(){return u},u},Gn=0,Pn=0,lt=!1,br=Object.create(null),Ur=Object.create(null),ct=Object.create(null);function ar(u){if((!u||typeof u.init!="function")&&!lt)throw new Error("requires `options.init` function");var i=u.dependencies,T=u.init,v=u.getTransferables,r=u.workerId;if(!Qt())return Mn(u);r==null&&(r="#default");var e="workerModule"+ ++Gn,o=u.name||e,a=null;i=i&&i.map(function(n){return typeof n=="function"&&!n.workerModuleData&&(lt=!0,n=ar({workerId:r,name:"<"+o+"> function dependency: "+n.name,init:`function(){return (
`+Rr(n)+`
)}`}),lt=!1),n&&n.workerModuleData&&(n=n.workerModuleData),n});function t(){for(var n=[],s=arguments.length;s--;)n[s]=arguments[s];if(!a){a=Wt(r,"registerModule",t.workerModuleData);var f=function(){a=null,Ur[r].delete(f)};(Ur[r]||(Ur[r]=new Set)).add(f)}return a.then(function(l){var c=l.isCallable;if(c)return Wt(r,"callModule",{id:e,args:n});throw new Error("Worker module function was called but `init` did not return a callable function")})}return t.workerModuleData={isWorkerModule:!0,id:e,name:o,dependencies:i,init:Rr(T),getTransferables:v&&Rr(v)},t}function Bn(u){Ur[u]&&Ur[u].forEach(function(i){i()}),br[u]&&(br[u].terminate(),delete br[u])}function Rr(u){var i=u.toString();return!/^function/.test(i)&&/^\w+\s*\(/.test(i)&&(i="function "+i),i}function On(u){var i=br[u];if(!i){var T=Rr(En);i=br[u]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+u.replace(/\*/g,"")+` **/

;(`+T+")()"],{type:"application/javascript"}))),i.onmessage=function(v){var r=v.data,e=r.messageId,o=ct[e];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete ct[e],o(r)}}return i}function Wt(u,i,T){var v=ze(),r=++Pn;return ct[r]=function(e){e.success?v.resolve(e.result):v.reject(new Error("Error in worker "+i+" call: "+e.error))},On(u).postMessage({messageId:r,action:i,data:T}),v}var Ln=ar({name:"Thenable",dependencies:[ze],init:function(u){return u}});function Zt(){var u=function(i){function T(M,I,m,F,L,O,E,R){var k=1-E;R.x=k*k*M+2*k*E*m+E*E*L,R.y=k*k*I+2*k*E*F+E*E*O}function v(M,I,m,F,L,O,E,R,k,P){var V=1-k;P.x=V*V*V*M+3*V*V*k*m+3*V*k*k*L+k*k*k*E,P.y=V*V*V*I+3*V*V*k*F+3*V*k*k*O+k*k*k*R}function r(M,I){for(var m=/([MLQCZ])([^MLQCZ]*)/g,F,L,O,E,R;F=m.exec(M);){var k=F[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(P){return parseFloat(P)});switch(F[1]){case"M":E=L=k[0],R=O=k[1];break;case"L":(k[0]!==E||k[1]!==R)&&I("L",E,R,E=k[0],R=k[1]);break;case"Q":{I("Q",E,R,E=k[2],R=k[3],k[0],k[1]);break}case"C":{I("C",E,R,E=k[4],R=k[5],k[0],k[1],k[2],k[3]);break}case"Z":(E!==L||R!==O)&&I("L",E,R,L,O);break}}}function e(M,I,m){m===void 0&&(m=16);var F={x:0,y:0};r(M,function(L,O,E,R,k,P,V,ae,j){switch(L){case"L":I(O,E,R,k);break;case"Q":{for(var W=O,ve=E,ue=1;ue<m;ue++)T(O,E,P,V,R,k,ue/(m-1),F),I(W,ve,F.x,F.y),W=F.x,ve=F.y;break}case"C":{for(var q=O,te=E,le=1;le<m;le++)v(O,E,P,V,ae,j,R,k,le/(m-1),F),I(q,te,F.x,F.y),q=F.x,te=F.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",t=new WeakMap,n={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(M,I){var m=M.getContext?M.getContext("webgl",n):M,F=t.get(m);if(!F){let V=function(q){var te=O[q];if(!te&&(te=O[q]=m.getExtension(q),!te))throw new Error(q+" not supported");return te},ae=function(q,te){var le=m.createShader(te);return m.shaderSource(le,q),m.compileShader(le),le},j=function(q,te,le,G){if(!E[q]){var re={},J={},B=m.createProgram();m.attachShader(B,ae(te,m.VERTEX_SHADER)),m.attachShader(B,ae(le,m.FRAGMENT_SHADER)),m.linkProgram(B),E[q]={program:B,transaction:function(K){m.useProgram(B),K({setUniform:function(Y,ce){for(var de=[],X=arguments.length-2;X-- >0;)de[X]=arguments[X+2];var se=J[ce]||(J[ce]=m.getUniformLocation(B,ce));m["uniform"+Y].apply(m,[se].concat(de))},setAttribute:function(Y,ce,de,X,se){var pe=re[Y];pe||(pe=re[Y]={buf:m.createBuffer(),loc:m.getAttribLocation(B,Y),data:null}),m.bindBuffer(m.ARRAY_BUFFER,pe.buf),m.vertexAttribPointer(pe.loc,ce,m.FLOAT,!1,0,0),m.enableVertexAttribArray(pe.loc),L?m.vertexAttribDivisor(pe.loc,X):V("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(pe.loc,X),se!==pe.data&&(m.bufferData(m.ARRAY_BUFFER,se,de),pe.data=se)}})}}}E[q].transaction(G)},W=function(q,te){k++;try{m.activeTexture(m.TEXTURE0+k);var le=R[q];le||(le=R[q]=m.createTexture(),m.bindTexture(m.TEXTURE_2D,le),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST)),m.bindTexture(m.TEXTURE_2D,le),te(le,k)}finally{k--}},ve=function(q,te,le){var G=m.createFramebuffer();P.push(G),m.bindFramebuffer(m.FRAMEBUFFER,G),m.activeTexture(m.TEXTURE0+te),m.bindTexture(m.TEXTURE_2D,q),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,q,0);try{le(G)}finally{m.deleteFramebuffer(G),m.bindFramebuffer(m.FRAMEBUFFER,P[--P.length-1]||null)}},ue=function(){O={},E={},R={},k=-1,P.length=0};var L=typeof WebGL2RenderingContext!="undefined"&&m instanceof WebGL2RenderingContext,O={},E={},R={},k=-1,P=[];m.canvas.addEventListener("webglcontextlost",function(q){ue(),q.preventDefault()},!1),t.set(m,F={gl:m,isWebGL2:L,getExtension:V,withProgram:j,withTexture:W,withTextureFramebuffer:ve,handleContextLoss:ue})}I(F)}function f(M,I,m,F,L,O,E,R){E===void 0&&(E=15),R===void 0&&(R=null),s(M,function(k){var P=k.gl,V=k.withProgram,ae=k.withTexture;ae("copy",function(j,W){P.texImage2D(P.TEXTURE_2D,0,P.RGBA,L,O,0,P.RGBA,P.UNSIGNED_BYTE,I),V("copy",o,a,function(ve){var ue=ve.setUniform,q=ve.setAttribute;q("aUV",2,P.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",W),P.bindFramebuffer(P.FRAMEBUFFER,R||null),P.disable(P.BLEND),P.colorMask(E&8,E&4,E&2,E&1),P.viewport(m,F,L,O),P.scissor(m,F,L,O),P.drawArrays(P.TRIANGLES,0,3)})})})}function l(M,I,m){var F=M.width,L=M.height;s(M,function(O){var E=O.gl,R=new Uint8Array(F*L*4);E.readPixels(0,0,F,L,E.RGBA,E.UNSIGNED_BYTE,R),M.width=I,M.height=m,f(E,R,0,0,F,L)})}var c=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:f,resizeWebGLCanvasWithoutClearing:l});function _(M,I,m,F,L,O){O===void 0&&(O=1);var E=new Uint8Array(M*I),R=F[2]-F[0],k=F[3]-F[1],P=[];e(m,function(q,te,le,G){P.push({x1:q,y1:te,x2:le,y2:G,minX:Math.min(q,le),minY:Math.min(te,G),maxX:Math.max(q,le),maxY:Math.max(te,G)})}),P.sort(function(q,te){return q.maxX-te.maxX});for(var V=0;V<M;V++)for(var ae=0;ae<I;ae++){var j=ve(F[0]+R*(V+.5)/M,F[1]+k*(ae+.5)/I),W=Math.pow(1-Math.abs(j)/L,O)/2;j<0&&(W=1-W),W=Math.max(0,Math.min(255,Math.round(W*255))),E[ae*M+V]=W}return E;function ve(q,te){for(var le=1/0,G=1/0,re=P.length;re--;){var J=P[re];if(J.maxX+G<=q)break;if(q+G>J.minX&&te-G<J.maxY&&te+G>J.minY){var B=p(q,te,J.x1,J.y1,J.x2,J.y2);B<le&&(le=B,G=Math.sqrt(le))}}return ue(q,te)&&(G=-G),G}function ue(q,te){for(var le=0,G=P.length;G--;){var re=P[G];if(re.maxX<=q)break;var J=re.y1>te!=re.y2>te&&q<(re.x2-re.x1)*(te-re.y1)/(re.y2-re.y1)+re.x1;J&&(le+=re.y1<re.y2?1:-1)}return le!==0}}function U(M,I,m,F,L,O,E,R,k,P){O===void 0&&(O=1),R===void 0&&(R=0),k===void 0&&(k=0),P===void 0&&(P=0),g(M,I,m,F,L,O,E,null,R,k,P)}function g(M,I,m,F,L,O,E,R,k,P,V){O===void 0&&(O=1),k===void 0&&(k=0),P===void 0&&(P=0),V===void 0&&(V=0);for(var ae=_(M,I,m,F,L,O),j=new Uint8Array(ae.length*4),W=0;W<ae.length;W++)j[W*4+V]=ae[W];f(E,j,k,P,M,I,1<<3-V,R)}function p(M,I,m,F,L,O){var E=L-m,R=O-F,k=E*E+R*R,P=k?Math.max(0,Math.min(1,((M-m)*E+(I-F)*R)/k)):0,V=M-(m+P*E),ae=I-(F+P*R);return V*V+ae*ae}var h=Object.freeze({__proto__:null,generate:_,generateIntoCanvas:U,generateIntoFramebuffer:g}),y="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",d="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",b="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",w=new Float32Array([0,0,2,0,0,2]),A=null,x=!1,N={},Z=new WeakMap;function H(M){if(!x&&!Q(M))throw new Error("WebGL generation not supported")}function S(M,I,m,F,L,O,E){if(O===void 0&&(O=1),E===void 0&&(E=null),!E&&(E=A,!E)){var R=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document!="undefined"?document.createElement("canvas"):null;if(!R)throw new Error("OffscreenCanvas or DOM canvas not supported");E=A=R.getContext("webgl",{depth:!1})}H(E);var k=new Uint8Array(M*I*4);s(E,function(j){var W=j.gl,ve=j.withTexture,ue=j.withTextureFramebuffer;ve("readable",function(q,te){W.texImage2D(W.TEXTURE_2D,0,W.RGBA,M,I,0,W.RGBA,W.UNSIGNED_BYTE,null),ue(q,te,function(le){C(M,I,m,F,L,O,W,le,0,0,0),W.readPixels(0,0,M,I,W.RGBA,W.UNSIGNED_BYTE,k)})})});for(var P=new Uint8Array(M*I),V=0,ae=0;V<k.length;V+=4)P[ae++]=k[V];return P}function D(M,I,m,F,L,O,E,R,k,P){O===void 0&&(O=1),R===void 0&&(R=0),k===void 0&&(k=0),P===void 0&&(P=0),C(M,I,m,F,L,O,E,null,R,k,P)}function C(M,I,m,F,L,O,E,R,k,P,V){O===void 0&&(O=1),k===void 0&&(k=0),P===void 0&&(P=0),V===void 0&&(V=0),H(E);var ae=[];e(m,function(j,W,ve,ue){ae.push(j,W,ve,ue)}),ae=new Float32Array(ae),s(E,function(j){var W=j.gl,ve=j.isWebGL2,ue=j.getExtension,q=j.withProgram,te=j.withTexture,le=j.withTextureFramebuffer,G=j.handleContextLoss;if(te("rawDistances",function(re,J){(M!==re._lastWidth||I!==re._lastHeight)&&W.texImage2D(W.TEXTURE_2D,0,W.RGBA,re._lastWidth=M,re._lastHeight=I,0,W.RGBA,W.UNSIGNED_BYTE,null),q("main",y,d,function(B){var he=B.setAttribute,K=B.setUniform,$=!ve&&ue("ANGLE_instanced_arrays"),Y=!ve&&ue("EXT_blend_minmax");he("aUV",2,W.STATIC_DRAW,0,w),he("aLineSegment",4,W.DYNAMIC_DRAW,1,ae),K.apply(void 0,["4f","uGlyphBounds"].concat(F)),K("1f","uMaxDistance",L),K("1f","uExponent",O),le(re,J,function(ce){W.enable(W.BLEND),W.colorMask(!0,!0,!0,!0),W.viewport(0,0,M,I),W.scissor(0,0,M,I),W.blendFunc(W.ONE,W.ONE),W.blendEquationSeparate(W.FUNC_ADD,ve?W.MAX:Y.MAX_EXT),W.clear(W.COLOR_BUFFER_BIT),ve?W.drawArraysInstanced(W.TRIANGLES,0,3,ae.length/4):$.drawArraysInstancedANGLE(W.TRIANGLES,0,3,ae.length/4)})}),q("post",o,b,function(B){B.setAttribute("aUV",2,W.STATIC_DRAW,0,w),B.setUniform("1i","tex",J),W.bindFramebuffer(W.FRAMEBUFFER,R),W.disable(W.BLEND),W.colorMask(V===0,V===1,V===2,V===3),W.viewport(k,P,M,I),W.scissor(k,P,M,I),W.drawArrays(W.TRIANGLES,0,3)})}),W.isContextLost())throw G(),new Error("webgl context lost")})}function Q(M){var I=!M||M===A?N:M.canvas||M,m=Z.get(I);if(m===void 0){x=!0;var F=null;try{var L=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],O=S(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,M);m=O&&L.length===O.length&&O.every(function(E,R){return E===L[R]}),m||(F="bad trial run results",console.info(L,O))}catch(E){m=!1,F=E.message}F&&console.warn("WebGL SDF generation not supported:",F),x=!1,Z.set(I,m)}return m}var z=Object.freeze({__proto__:null,generate:S,generateIntoCanvas:D,generateIntoFramebuffer:C,isSupported:Q});function oe(M,I,m,F,L,O){L===void 0&&(L=Math.max(F[2]-F[0],F[3]-F[1])/2),O===void 0&&(O=1);try{return S.apply(z,arguments)}catch(E){return console.info("WebGL SDF generation failed, falling back to JS",E),_.apply(h,arguments)}}function ie(M,I,m,F,L,O,E,R,k,P){L===void 0&&(L=Math.max(F[2]-F[0],F[3]-F[1])/2),O===void 0&&(O=1),R===void 0&&(R=0),k===void 0&&(k=0),P===void 0&&(P=0);try{return D.apply(z,arguments)}catch(V){return console.info("WebGL SDF generation failed, falling back to JS",V),U.apply(h,arguments)}}return i.forEachPathCommand=r,i.generate=oe,i.generateIntoCanvas=ie,i.javascript=h,i.pathToLineSegments=e,i.webgl=z,i.webglUtils=c,Object.defineProperty(i,"__esModule",{value:!0}),i}({});return u}function Rn(){var u=function(i){var T={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},v={},r={};v.L=1,r[1]="L",Object.keys(T).forEach(function(G,re){v[G]=1<<re+1,r[v[G]]=G}),Object.freeze(v);var e=v.LRI|v.RLI|v.FSI,o=v.L|v.R|v.AL,a=v.B|v.S|v.WS|v.ON|v.FSI|v.LRI|v.RLI|v.PDI,t=v.BN|v.RLE|v.LRE|v.RLO|v.LRO|v.PDF,n=v.S|v.WS|v.B|e|v.PDI|t,s=null;function f(){if(!s){s=new Map;var G=function(J){if(T.hasOwnProperty(J)){var B=0;T[J].split(",").forEach(function(he){var K=he.split("+"),$=K[0],Y=K[1];$=parseInt($,36),Y=Y?parseInt(Y,36):0,s.set(B+=$,v[J]);for(var ce=0;ce<Y;ce++)s.set(++B,v[J])})}};for(var re in T)G(re)}}function l(G){return f(),s.get(G.codePointAt(0))||v.L}function c(G){return r[l(G)]}var _={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function U(G,re){var J=36,B=0,he=new Map,K=re&&new Map,$;return G.split(",").forEach(function Y(ce){if(ce.indexOf("+")!==-1)for(var de=+ce;de--;)Y($);else{$=ce;var X=ce.split(">"),se=X[0],pe=X[1];se=String.fromCodePoint(B+=parseInt(se,J)),pe=String.fromCodePoint(B+=parseInt(pe,J)),he.set(se,pe),re&&K.set(pe,se)}}),{map:he,reverseMap:K}}var g,p,h;function y(){if(!g){var G=U(_.pairs,!0),re=G.map,J=G.reverseMap;g=re,p=J,h=U(_.canonical,!1).map}}function d(G){return y(),g.get(G)||null}function b(G){return y(),p.get(G)||null}function w(G){return y(),h.get(G)||null}var A=v.L,x=v.R,N=v.EN,Z=v.ES,H=v.ET,S=v.AN,D=v.CS,C=v.B,Q=v.S,z=v.ON,oe=v.BN,ie=v.NSM,M=v.AL,I=v.LRO,m=v.RLO,F=v.LRE,L=v.RLE,O=v.PDF,E=v.LRI,R=v.RLI,k=v.FSI,P=v.PDI;function V(G,re){for(var J=125,B=new Uint32Array(G.length),he=0;he<G.length;he++)B[he]=l(G[he]);var K=new Map;function $(Ee,We){var Ge=B[Ee];B[Ee]=We,K.set(Ge,K.get(Ge)-1),Ge&a&&K.set(a,K.get(a)-1),K.set(We,(K.get(We)||0)+1),We&a&&K.set(a,(K.get(a)||0)+1)}for(var Y=new Uint8Array(G.length),ce=new Map,de=[],X=null,se=0;se<G.length;se++)X||de.push(X={start:se,end:G.length-1,level:re==="rtl"?1:re==="ltr"?0:Pt(se,!1)}),B[se]&C&&(X.end=se,X=null);for(var pe=L|F|m|I|e|P|O|C,ye=function(Ee){return Ee+(Ee&1?1:2)},Te=function(Ee){return Ee+(Ee&1?2:1)},xe=0;xe<de.length;xe++){X=de[xe];var fe=[{_level:X.level,_override:0,_isolate:0}],ne=void 0,_e=0,ge=0,Pe=0;K.clear();for(var Se=X.start;Se<=X.end;Se++){var we=B[Se];if(ne=fe[fe.length-1],K.set(we,(K.get(we)||0)+1),we&a&&K.set(a,(K.get(a)||0)+1),we&pe)if(we&(L|F)){Y[Se]=ne._level;var Ve=(we===L?Te:ye)(ne._level);Ve<=J&&!_e&&!ge?fe.push({_level:Ve,_override:0,_isolate:0}):_e||ge++}else if(we&(m|I)){Y[Se]=ne._level;var or=(we===m?Te:ye)(ne._level);or<=J&&!_e&&!ge?fe.push({_level:or,_override:we&m?x:A,_isolate:0}):_e||ge++}else if(we&e){we&k&&(we=Pt(Se+1,!0)===1?R:E),Y[Se]=ne._level,ne._override&&$(Se,ne._override);var Fe=(we===R?Te:ye)(ne._level);Fe<=J&&_e===0&&ge===0?(Pe++,fe.push({_level:Fe,_override:0,_isolate:1,_isolInitIndex:Se})):_e++}else if(we&P){if(_e>0)_e--;else if(Pe>0){for(ge=0;!fe[fe.length-1]._isolate;)fe.pop();var ir=fe[fe.length-1]._isolInitIndex;ir!=null&&(ce.set(ir,Se),ce.set(Se,ir)),fe.pop(),Pe--}ne=fe[fe.length-1],Y[Se]=ne._level,ne._override&&$(Se,ne._override)}else we&O?(_e===0&&(ge>0?ge--:!ne._isolate&&fe.length>1&&(fe.pop(),ne=fe[fe.length-1])),Y[Se]=ne._level):we&C&&(Y[Se]=X.level);else Y[Se]=ne._level,ne._override&&we!==oe&&$(Se,ne._override)}for(var be=[],me=null,Ce=X.start;Ce<=X.end;Ce++){var Be=B[Ce];if(!(Be&t)){var Ue=Y[Ce],Me=Be&e,Ne=Be===P;me&&Ue===me._level?(me._end=Ce,me._endsWithIsolInit=Me):be.push(me={_start:Ce,_end:Ce,_level:Ue,_startsWithPDI:Ne,_endsWithIsolInit:Me})}}for(var De=[],ke=0;ke<be.length;ke++){var Oe=be[ke];if(!Oe._startsWithPDI||Oe._startsWithPDI&&!ce.has(Oe._start)){for(var je=[me=Oe],Re=void 0;me&&me._endsWithIsolInit&&(Re=ce.get(me._end))!=null;)for(var Xe=ke+1;Xe<be.length;Xe++)if(be[Xe]._start===Re){je.push(me=be[Xe]);break}for(var Ze=[],Nr=0;Nr<je.length;Nr++)for(var gt=je[Nr],zr=gt._start;zr<=gt._end;zr++)Ze.push(zr);for(var tn=Y[Ze[0]],mt=X.level,_r=Ze[0]-1;_r>=0;_r--)if(!(B[_r]&t)){mt=Y[_r];break}var Vr=Ze[Ze.length-1],nn=Y[Vr],yt=X.level;if(!(B[Vr]&e)){for(var Tr=Vr+1;Tr<=X.end;Tr++)if(!(B[Tr]&t)){yt=Y[Tr];break}}De.push({_seqIndices:Ze,_sosType:Math.max(mt,tn)%2?x:A,_eosType:Math.max(yt,nn)%2?x:A})}}for(var jr=0;jr<De.length;jr++){var Xr=De[jr],ee=Xr._seqIndices,sr=Xr._sosType,an=Xr._eosType;if(K.get(ie))for(var Sr=0;Sr<ee.length;Sr++){var bt=ee[Sr];if(B[bt]&ie){for(var Yr=sr,wr=Sr-1;wr>=0;wr--)if(!(B[ee[wr]]&t)){Yr=B[ee[wr]];break}$(bt,Yr&(e|P)?z:Yr)}}if(K.get(N))for(var xr=0;xr<ee.length;xr++){var Ut=ee[xr];if(B[Ut]&N)for(var kr=xr-1;kr>=-1;kr--){var _t=kr===-1?sr:B[ee[kr]];if(_t&o){_t===M&&$(Ut,S);break}}}if(K.get(M))for(var Hr=0;Hr<ee.length;Hr++){var Tt=ee[Hr];B[Tt]&M&&$(Tt,x)}if(K.get(Z)||K.get(D))for(var fr=1;fr<ee.length-1;fr++){var Jr=ee[fr];if(B[Jr]&(Z|D)){for(var qe=0,Kr=0,Qr=fr-1;Qr>=0&&(qe=B[ee[Qr]],!!(qe&t));Qr--);for(var Zr=fr+1;Zr<ee.length&&(Kr=B[ee[Zr]],!!(Kr&t));Zr++);qe===Kr&&(B[Jr]===Z?qe===N:qe&(N|S))&&$(Jr,qe)}}if(K.get(N))for(var lr=0;lr<ee.length;lr++){var on=ee[lr];if(B[on]&N){for(var Fr=lr-1;Fr>=0&&B[ee[Fr]]&(H|t);Fr--)$(ee[Fr],N);for(var Cr=lr+1;Cr<ee.length&&B[ee[Cr]]&(H|t);Cr++)$(ee[Cr],N)}}if(K.get(H)||K.get(Z)||K.get(D))for(var ur=0;ur<ee.length;ur++){var St=ee[ur];if(B[St]&(H|Z|D)){$(St,z);for(var Dr=ur-1;Dr>=0&&B[ee[Dr]]&t;Dr--)$(ee[Dr],z);for(var Ar=ur+1;Ar<ee.length&&B[ee[Ar]]&t;Ar++)$(ee[Ar],z)}}if(K.get(N))for(var qr=0,wt=sr;qr<ee.length;qr++){var xt=ee[qr],$r=B[xt];$r&N?wt===A&&$(xt,A):$r&o&&(wt=$r)}if(K.get(a)){var cr=x|N|S,kt=cr|A,Er=[];{for(var $e=[],er=0;er<ee.length;er++)if(B[ee[er]]&a){var hr=G[ee[er]],Ft=void 0;if(d(hr)!==null)if($e.length<63)$e.push({char:hr,seqIndex:er});else break;else if((Ft=b(hr))!==null)for(var dr=$e.length-1;dr>=0;dr--){var et=$e[dr].char;if(et===Ft||et===b(w(hr))||d(w(et))===hr){Er.push([$e[dr].seqIndex,er]),$e.length=dr;break}}}Er.sort(function(Ee,We){return Ee[0]-We[0]})}for(var rt=0;rt<Er.length;rt++){for(var Ct=Er[rt],vr=Ct[0],Mr=Ct[1],Dt=!1,Ie=0,tt=vr+1;tt<Mr;tt++){var nt=ee[tt];if(B[nt]&kt){Dt=!0;var At=B[nt]&cr?x:A;if(At===rr(nt)){Ie=At;break}}}if(Dt&&!Ie){Ie=sr;for(var at=vr-1;at>=0;at--){var Gr=ee[at];if(B[Gr]&kt){var Et=B[Gr]&cr?x:A;Et!==rr(Gr)?Ie=Et:Ie=rr(Gr);break}}}if(Ie){if(B[ee[vr]]=B[ee[Mr]]=Ie,Ie!==rr(ee[vr])){for(var pr=vr+1;pr<ee.length;pr++)if(!(B[ee[pr]]&t)){l(G[ee[pr]])&ie&&(B[ee[pr]]=Ie);break}}if(Ie!==rr(ee[Mr])){for(var gr=Mr+1;gr<ee.length;gr++)if(!(B[ee[gr]]&t)){l(G[ee[gr]])&ie&&(B[ee[gr]]=Ie);break}}}}for(var Ye=0;Ye<ee.length;Ye++)if(B[ee[Ye]]&a){for(var Mt=Ye,ot=Ye,it=sr,mr=Ye-1;mr>=0;mr--)if(B[ee[mr]]&t)Mt=mr;else{it=B[ee[mr]]&cr?x:A;break}for(var Gt=an,yr=Ye+1;yr<ee.length;yr++)if(B[ee[yr]]&(a|t))ot=yr;else{Gt=B[ee[yr]]&cr?x:A;break}for(var Pr=Mt;Pr<=ot;Pr++)B[ee[Pr]]=it===Gt?it:rr(ee[Pr]);Ye=ot}}}for(var Le=X.start;Le<=X.end;Le++){var sn=Y[Le],Br=B[Le];if(sn&1?Br&(A|N|S)&&Y[Le]++:Br&x?Y[Le]++:Br&(S|N)&&(Y[Le]+=2),Br&t&&(Y[Le]=Le===0?X.level:Y[Le-1]),Le===X.end||l(G[Le])&(Q|C))for(var Or=Le;Or>=0&&l(G[Or])&n;Or--)Y[Or]=X.level}}return{levels:Y,paragraphs:de};function Pt(Ee,We){for(var Ge=Ee;Ge<G.length;Ge++){var He=B[Ge];if(He&(x|M))return 1;if(He&(C|A)||We&&He===P)return 0;if(He&e){var Bt=fn(Ge);Ge=Bt===-1?G.length:Bt}}return 0}function fn(Ee){for(var We=1,Ge=Ee+1;Ge<G.length;Ge++){var He=B[Ge];if(He&C)break;if(He&P){if(--We===0)return Ge}else He&e&&We++}return-1}function rr(Ee){return Y[Ee]&1?x:A}}var ae="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",j;function W(){if(!j){var G=U(ae,!0),re=G.map,J=G.reverseMap;J.forEach(function(B,he){re.set(he,B)}),j=re}}function ve(G){return W(),j.get(G)||null}function ue(G,re,J,B){var he=G.length;J=Math.max(0,J==null?0:+J),B=Math.min(he-1,B==null?he-1:+B);for(var K=new Map,$=J;$<=B;$++)if(re[$]&1){var Y=ve(G[$]);Y!==null&&K.set($,Y)}return K}function q(G,re,J,B){var he=G.length;J=Math.max(0,J==null?0:+J),B=Math.min(he-1,B==null?he-1:+B);var K=[];return re.paragraphs.forEach(function($){var Y=Math.max(J,$.start),ce=Math.min(B,$.end);if(Y<ce){for(var de=re.levels.slice(Y,ce+1),X=ce;X>=Y&&l(G[X])&n;X--)de[X]=$.level;for(var se=$.level,pe=1/0,ye=0;ye<de.length;ye++){var Te=de[ye];Te>se&&(se=Te),Te<pe&&(pe=Te|1)}for(var xe=se;xe>=pe;xe--)for(var fe=0;fe<de.length;fe++)if(de[fe]>=xe){for(var ne=fe;fe+1<de.length&&de[fe+1]>=xe;)fe++;fe>ne&&K.push([ne+J,fe+J])}}}),K}function te(G,re,J,B){var he=le(G,re,J,B),K=[].concat(G);return he.forEach(function($,Y){K[Y]=(re.levels[$]&1?ve(G[$]):null)||G[$]}),K.join("")}function le(G,re,J,B){for(var he=q(G,re,J,B),K=[],$=0;$<G.length;$++)K[$]=$;return he.forEach(function(Y){for(var ce=Y[0],de=Y[1],X=K.slice(ce,de+1),se=X.length;se--;)K[de-se]=X[se]}),K}return i.closingToOpeningBracket=b,i.getBidiCharType=l,i.getBidiCharTypeName=c,i.getCanonicalBracket=w,i.getEmbeddingLevels=V,i.getMirroredCharacter=ve,i.getMirroredCharactersMap=ue,i.getReorderSegments=q,i.getReorderedIndices=le,i.getReorderedString=te,i.openingToClosingBracket=d,Object.defineProperty(i,"__esModule",{value:!0}),i}({});return u}const qt=/\bvoid\s+main\s*\(\s*\)\s*{/g;function ht(u){const i=/^[ \t]*#include +<([\w\d./]+)>/gm;function T(v,r){let e=pn[r];return e?ht(e):v}return u.replace(i,T)}const Ae=[];for(let u=0;u<256;u++)Ae[u]=(u<16?"0":"")+u.toString(16);function In(){const u=Math.random()*4294967295|0,i=Math.random()*4294967295|0,T=Math.random()*4294967295|0,v=Math.random()*4294967295|0;return(Ae[u&255]+Ae[u>>8&255]+Ae[u>>16&255]+Ae[u>>24&255]+"-"+Ae[i&255]+Ae[i>>8&255]+"-"+Ae[i>>16&15|64]+Ae[i>>24&255]+"-"+Ae[T&63|128]+Ae[T>>8&255]+"-"+Ae[T>>16&255]+Ae[T>>24&255]+Ae[v&255]+Ae[v>>8&255]+Ae[v>>16&255]+Ae[v>>24&255]).toUpperCase()}const Ke=Object.assign||function(){let u=arguments[0];for(let i=1,T=arguments.length;i<T;i++){let v=arguments[i];if(v)for(let r in v)v.hasOwnProperty(r)&&(u[r]=v[r])}return u},Wn=Date.now(),Nt=new WeakMap,zt=new Map;let Nn=1e10;function dt(u,i){const T=Xn(i);let v=Nt.get(u);if(v||Nt.set(u,v=Object.create(null)),v[T])return new v[T];const r=`_onBeforeCompile${T}`,e=function(n){u.onBeforeCompile.call(this,n);const s=this.customProgramCacheKey()+"|"+n.vertexShader+"|"+n.fragmentShader;let f=zt[s];if(!f){const l=zn(n,i,T);f=zt[s]=l}n.vertexShader=f.vertexShader,n.fragmentShader=f.fragmentShader,Ke(n.uniforms,this.uniforms),i.timeUniform&&(n.uniforms[i.timeUniform]={get value(){return Date.now()-Wn}}),this[r]&&this[r](n)},o=function(){return a(i.chained?u:u.clone())},a=function(n){const s=Object.create(n,t);return Object.defineProperty(s,"baseMaterial",{value:u}),Object.defineProperty(s,"id",{value:Nn++}),s.uuid=In(),s.uniforms=Ke({},n.uniforms,i.uniforms),s.defines=Ke({},n.defines,i.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${T}`]="",s.extensions=Ke({},n.extensions,i.extensions),s._listeners=void 0,s},t={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return u.customProgramCacheKey()+"|"+T}},onBeforeCompile:{get(){return e},set(n){this[r]=n}},copy:{writable:!0,configurable:!0,value:function(n){return u.copy.call(this,n),!u.isShaderMaterial&&!u.isDerivedMaterial&&(Ke(this.extensions,n.extensions),Ke(this.defines,n.defines),Ke(this.uniforms,cn.clone(n.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const n=new u.constructor;return a(n).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let n=this._depthMaterial;return n||(n=this._depthMaterial=dt(u.isDerivedMaterial?u.getDepthMaterial():new hn({depthPacking:dn}),i),n.defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let n=this._distanceMaterial;return n||(n=this._distanceMaterial=dt(u.isDerivedMaterial?u.getDistanceMaterial():new vn,i),n.defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:n,_distanceMaterial:s}=this;n&&n.dispose(),s&&s.dispose(),u.dispose.call(this)}}};return v[T]=o,new o}function zn({vertexShader:u,fragmentShader:i},T,v){let{vertexDefs:r,vertexMainIntro:e,vertexMainOutro:o,vertexTransform:a,fragmentDefs:t,fragmentMainIntro:n,fragmentMainOutro:s,fragmentColorTransform:f,customRewriter:l,timeUniform:c}=T;if(r=r||"",e=e||"",o=o||"",t=t||"",n=n||"",s=s||"",(a||l)&&(u=ht(u)),(f||l)&&(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),i=ht(i)),l){let _=l({vertexShader:u,fragmentShader:i});u=_.vertexShader,i=_.fragmentShader}if(f){let _=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,U=>(_.push(U),"")),s=`${f}
${_.join(`
`)}
${s}`}if(c){const _=`
uniform float ${c};
`;r=_+r,t=_+t}return a&&(u=`vec3 troika_position_${v};
vec3 troika_normal_${v};
vec2 troika_uv_${v};
${u}
`,r=`${r}
void troikaVertexTransform${v}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${a}
}
`,e=`
troika_position_${v} = vec3(position);
troika_normal_${v} = vec3(normal);
troika_uv_${v} = vec2(uv);
troikaVertexTransform${v}(troika_position_${v}, troika_normal_${v}, troika_uv_${v});
${e}
`,u=u.replace(/\b(position|normal|uv)\b/g,(_,U,g,p)=>/\battribute\s+vec[23]\s+$/.test(p.substr(0,g))?U:`troika_${U}_${v}`)),u=Vt(u,v,r,e,o),i=Vt(i,v,t,n,s),{vertexShader:u,fragmentShader:i}}function Vt(u,i,T,v,r){return(v||r||T)&&(u=u.replace(qt,`
${T}
void troikaOrigMain${i}() {`),u+=`
void main() {
  ${v}
  troikaOrigMain${i}();
  ${r}
}`),u}function Vn(u,i){return u==="uniforms"?void 0:typeof i=="function"?i.toString():i}let jn=0;const jt=new Map;function Xn(u){const i=JSON.stringify(u,Vn);let T=jt.get(i);return T==null&&jt.set(i,T=++jn),T}function Yn(u,i,T){const{defaultFontURL:v}=T,r=Object.create(null),e=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a=/[\s\-\u007C\u00AD\u2010\u2012-\u2014\u2027\u2056\u2E17\u2E40]/;function t(p,h){function y(){const d=b=>{console.error(`Failure loading font ${p}${p===v?"":"; trying fallback"}`,b),p!==v&&(p=v,y())};try{const b=new XMLHttpRequest;b.open("get",p,!0),b.responseType="arraybuffer",b.onload=function(){if(b.status>=400)d(new Error(b.statusText));else if(b.status>0)try{const w=u(b.response);h(w)}catch(w){d(w)}},b.onerror=d,b.send()}catch(b){d(b)}}y()}function n(p,h){p||(p=v);let y=r[p];y?y.pending?y.pending.push(h):h(y):(r[p]={pending:[h]},t(p,d=>{let b=r[p].pending;r[p]=d,b.forEach(w=>w(d))}))}function s({text:p="",font:h=v,sdfGlyphSize:y=64,fontSize:d=1,letterSpacing:b=0,lineHeight:w="normal",maxWidth:A=e,direction:x,textAlign:N="left",textIndent:Z=0,whiteSpace:H="normal",overflowWrap:S="normal",anchorX:D=0,anchorY:C=0,includeCaretPositions:Q=!1,chunkedBoundsSize:z=8192,colorRanges:oe=null},ie,M=!1){const I=_(),m={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),d=+d,b=+b,A=+A,w=w||"normal",Z=+Z,n(h,F=>{const L=isFinite(A);let O=null,E=null,R=null,k=null,P=null,V=null,ae=null,j=0,W=0,ve=H!=="nowrap";const{ascender:ue,descender:q,unitsPerEm:te}=F;m.fontLoad=_()-I;const le=_(),G=d/te;w==="normal"&&(w=(ue-q)/te),w=w*d;const re=(w-(ue-q)*G)/2,J=-(ue*G+re),B=Math.min(w,(ue-q)*G),he=(ue+q)/2*G-B/2;let K=Z,$=new U;const Y=[$];F.forEachGlyph(p,d,b,(X,se,pe)=>{const ye=p.charAt(pe),Te=X.advanceWidth*G,xe=$.count;let fe;if("isEmpty"in X||(X.isWhitespace=!!ye&&/\s/.test(ye),X.canBreakAfter=!!ye&&a.test(ye),X.isEmpty=X.xMin===X.xMax||X.yMin===X.yMax||o.test(ye)),!X.isWhitespace&&!X.isEmpty&&W++,ve&&L&&!X.isWhitespace&&se+Te+K>A&&xe){if($.glyphAt(xe-1).glyphObj.canBreakAfter)fe=new U,K=-se;else for(let _e=xe;_e--;)if(_e===0&&S==="break-word"){fe=new U,K=-se;break}else if($.glyphAt(_e).glyphObj.canBreakAfter){fe=$.splitAt(_e+1);const ge=fe.glyphAt(0).x;K-=ge;for(let Pe=fe.count;Pe--;)fe.glyphAt(Pe).x-=ge;break}fe&&($.isSoftWrapped=!0,$=fe,Y.push($),j=A)}let ne=$.glyphAt($.count);ne.glyphObj=X,ne.x=se+K,ne.width=Te,ne.charIndex=pe,ye===`
`&&($=new U,Y.push($),K=-(se+Te+b*d)+Z)}),Y.forEach(X=>{for(let se=X.count;se--;){let{glyphObj:pe,x:ye,width:Te}=X.glyphAt(se);if(!pe.isWhitespace){X.width=ye+Te,X.width>j&&(j=X.width);return}}});let ce=0,de=0;if(D&&(typeof D=="number"?ce=-D:typeof D=="string"&&(ce=-j*(D==="left"?0:D==="center"?.5:D==="right"?1:l(D)))),C){if(typeof C=="number")de=-C;else if(typeof C=="string"){let X=Y.length*w;de=C==="top"?0:C==="top-baseline"?-J:C==="middle"?X/2:C==="bottom"?X:C==="bottom-baseline"?X-re+q*G:l(C)*X}}if(!M){const X=i.getEmbeddingLevels(p,x);O=new Uint16Array(W),E=new Float32Array(W*2),R={},V=[e,e,-e,-e],ae=[];let se=J;Q&&(P=new Float32Array(p.length*3)),oe&&(k=new Uint8Array(W*3));let pe=0,ye=-1,Te=-1,xe,fe;if(Y.forEach((ne,_e)=>{let{count:ge,width:Pe}=ne;if(ge>0){let Se=0;for(let be=ge;be--&&ne.glyphAt(be).glyphObj.isWhitespace;)Se++;let we=0,Ve=0;if(N==="center")we=(j-Pe)/2;else if(N==="right")we=j-Pe;else if(N==="justify"&&ne.isSoftWrapped){let be=0;for(let me=ge-Se;me--;)ne.glyphAt(me).glyphObj.isWhitespace&&be++;Ve=(j-Pe)/be}if(Ve||we){let be=0;for(let me=0;me<ge;me++){let Ce=ne.glyphAt(me);const Be=Ce.glyphObj;Ce.x+=we+be,Ve!==0&&Be.isWhitespace&&me<ge-Se&&(be+=Ve,Ce.width+=Ve)}}const or=i.getReorderSegments(p,X,ne.glyphAt(0).charIndex,ne.glyphAt(ne.count-1).charIndex);for(let be=0;be<or.length;be++){const[me,Ce]=or[be];let Be=1/0,Ue=-1/0;for(let Me=0;Me<ge;Me++)if(ne.glyphAt(Me).charIndex>=me){let Ne=Me,De=Me;for(;De<ge;De++){let ke=ne.glyphAt(De);if(ke.charIndex>Ce)break;De<ge-Se&&(Be=Math.min(Be,ke.x),Ue=Math.max(Ue,ke.x+ke.width))}for(let ke=Ne;ke<De;ke++){const Oe=ne.glyphAt(ke);Oe.x=Ue-(Oe.x+Oe.width-Be)}break}}let Fe;const ir=be=>Fe=be;for(let be=0;be<ge;be++){let me=ne.glyphAt(be);Fe=me.glyphObj;const Ce=Fe.index,Be=X.levels[me.charIndex]&1;if(Be){const Ue=i.getMirroredCharacter(p[me.charIndex]);Ue&&F.forEachGlyph(Ue,0,0,ir)}if(Q){const{charIndex:Ue}=me,Me=me.x+ce,Ne=me.x+me.width+ce;P[Ue*3]=Be?Ne:Me,P[Ue*3+1]=Be?Me:Ne,P[Ue*3+2]=se+he+de;const De=Ue-ye;De>1&&c(P,ye,De),ye=Ue}if(oe){const{charIndex:Ue}=me;for(;Ue>Te;)Te++,oe.hasOwnProperty(Te)&&(fe=oe[Te])}if(!Fe.isWhitespace&&!Fe.isEmpty){const Ue=pe++;R[Ce]||(R[Ce]={path:Fe.path,pathBounds:[Fe.xMin,Fe.yMin,Fe.xMax,Fe.yMax]});const Me=me.x+ce,Ne=se+de;E[Ue*2]=Me,E[Ue*2+1]=Ne;const De=Me+Fe.xMin*G,ke=Ne+Fe.yMin*G,Oe=Me+Fe.xMax*G,je=Ne+Fe.yMax*G;De<V[0]&&(V[0]=De),ke<V[1]&&(V[1]=ke),Oe>V[2]&&(V[2]=Oe),je>V[3]&&(V[3]=je),Ue%z===0&&(xe={start:Ue,end:Ue,rect:[e,e,-e,-e]},ae.push(xe)),xe.end++;const Re=xe.rect;if(De<Re[0]&&(Re[0]=De),ke<Re[1]&&(Re[1]=ke),Oe>Re[2]&&(Re[2]=Oe),je>Re[3]&&(Re[3]=je),O[Ue]=Ce,oe){const Xe=Ue*3;k[Xe]=fe>>16&255,k[Xe+1]=fe>>8&255,k[Xe+2]=fe&255}}}}se-=w}),P){const ne=p.length-ye;ne>1&&c(P,ye,ne)}}m.typesetting=_()-le,ie({glyphIds:O,glyphPositions:E,glyphData:R,caretPositions:P,caretHeight:B,glyphColors:k,chunkedBounds:ae,fontSize:d,unitsPerEm:te,ascender:ue*G,descender:q*G,lineHeight:w,topBaseline:J,blockBounds:[ce,de-Y.length*w,ce+j,de],visibleBounds:V,timings:m})})}function f(p,h){s(p,y=>{const[d,b,w,A]=y.blockBounds;h({width:w-d,height:A-b})},{metricsOnly:!0})}function l(p){let h=p.match(/^([\d.]+)%$/),y=h?parseFloat(h[1]):NaN;return isNaN(y)?0:y/100}function c(p,h,y){const d=p[h*3],b=p[h*3+1],w=p[h*3+2],A=(b-d)/y;for(let x=0;x<y;x++){const N=(h+x)*3;p[N]=d+A*x,p[N+1]=d+A*(x+1),p[N+2]=w}}function _(){return(self.performance||Date).now()}function U(){this.data=[]}const g=["glyphObj","x","width","charIndex"];return U.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/g.length)},glyphAt(p){let h=U.flyweight;return h.data=this.data,h.index=p,h},splitAt(p){let h=new U;return h.data=this.data.splice(p*g.length),h}},U.flyweight=g.reduce((p,h,y,d)=>(Object.defineProperty(p,h,{get(){return this.data[this.index*g.length+y]},set(b){this.data[this.index*g.length+y]=b}}),p),{data:null,index:0}),{typeset:s,measure:f,loadFont:n}}const Qe=()=>(self.performance||Date).now(),Wr=Zt();let Xt;function Hn(u,i,T,v,r,e,o,a,t,n,s=!0){return s?Jn(u,i,T,v,r,e,o,a,t,n).then(null,f=>(Xt||(console.warn("WebGL SDF generation failed, falling back to JS",f),Xt=!0),Yt(u,i,T,v,r,e,o,a,t,n))):Yt(u,i,T,v,r,e,o,a,t,n)}const Jn=function(){const u=[];let T=0;function v(){const r=Qe();for(;u.length&&Qe()-r<5;)u.shift()();T=u.length?setTimeout(v,0):0}return(...r)=>{const e=ze();return u.push(()=>{const o=Qe();try{Wr.webgl.generateIntoCanvas(...r),e.resolve({timing:Qe()-o})}catch(a){e.reject(a)}}),T||(T=setTimeout(v,0)),e}}(),Yt=function(){const T={};let v=0;return function(r,e,o,a,t,n,s,f,l,c){const _="TroikaTextSDFGenerator_JS_"+v++%4;let U=T[_];return U||(U=T[_]={workerModule:ar({name:_,workerId:_,dependencies:[Zt,Qe],init(g,p){const h=g().javascript.generate;return function(...y){const d=p();return{textureData:h(...y),timing:p()-d}}},getTransferables(g){return[g.textureData.buffer]}}),requests:0,idleTimer:null}),U.requests++,clearTimeout(U.idleTimer),U.workerModule(r,e,o,a,t,n).then(({textureData:g,timing:p})=>{const h=Qe(),y=new Uint8Array(g.length*4);for(let d=0;d<g.length;d++)y[d*4+c]=g[d];return Wr.webglUtils.renderImageData(s,y,f,l,r,e,1<<3-c),p+=Qe()-h,--U.requests===0&&(U.idleTimer=setTimeout(()=>{Bn(_)},2e3)),{timing:p}})}}();function Kn(u){u._warm||(Wr.webgl.isSupported(u),u._warm=!0)}const Qn=Wr.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Zn(){return typeof window=="undefined"&&(self.window=self),function(u){var i={parse:function(r){var e=i._bin,o=new Uint8Array(r);if(e.readASCII(o,0,4)=="ttcf"){var a=4;e.readUshort(o,a),a+=2,e.readUshort(o,a),a+=2;var t=e.readUint(o,a);a+=4;for(var n=[],s=0;s<t;s++){var f=e.readUint(o,a);a+=4,n.push(i._readFont(o,f))}return n}return[i._readFont(o,0)]},_readFont:function(r,e){var o=i._bin,a=e;o.readFixed(r,e),e+=4;var t=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2;for(var n=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:r,_offset:a},f={},l=0;l<t;l++){var c=o.readASCII(r,e,4);e+=4,o.readUint(r,e),e+=4;var _=o.readUint(r,e);e+=4;var U=o.readUint(r,e);e+=4,f[c]={offset:_,length:U}}for(l=0;l<n.length;l++){var g=n[l];f[g]&&(s[g.trim()]=i[g.trim()].parse(r,f[g].offset,f[g].length,s))}return s},_tabOffset:function(r,e,o){for(var a=i._bin,t=a.readUshort(r,o+4),n=o+12,s=0;s<t;s++){var f=a.readASCII(r,n,4);n+=4,a.readUint(r,n),n+=4;var l=a.readUint(r,n);if(n+=4,a.readUint(r,n),n+=4,f==e)return l}return 0}};i._bin={readFixed:function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<8|r[e+3])/65540},readF2dot14:function(r,e){return i._bin.readShort(r,e)/16384},readInt:function(r,e){return i._bin._view(r).getInt32(e)},readInt8:function(r,e){return i._bin._view(r).getInt8(e)},readShort:function(r,e){return i._bin._view(r).getInt16(e)},readUshort:function(r,e){return i._bin._view(r).getUint16(e)},readUshorts:function(r,e,o){for(var a=[],t=0;t<o;t++)a.push(i._bin.readUshort(r,e+2*t));return a},readUint:function(r,e){return i._bin._view(r).getUint32(e)},readUint64:function(r,e){return 4294967296*i._bin.readUint(r,e)+i._bin.readUint(r,e+4)},readASCII:function(r,e,o){for(var a="",t=0;t<o;t++)a+=String.fromCharCode(r[e+t]);return a},readUnicode:function(r,e,o){for(var a="",t=0;t<o;t++){var n=r[e++]<<8|r[e++];a+=String.fromCharCode(n)}return a},_tdec:typeof window!="undefined"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,e,o){var a=i._bin._tdec;return a&&e==0&&o==r.length?a.decode(r):i._bin.readASCII(r,e,o)},readBytes:function(r,e,o){for(var a=[],t=0;t<o;t++)a.push(r[e+t]);return a},readASCIIArray:function(r,e,o){for(var a=[],t=0;t<o;t++)a.push(String.fromCharCode(r[e+t]));return a},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},i._lctf={},i._lctf.parse=function(r,e,o,a,t){var n=i._bin,s={},f=e;n.readFixed(r,e),e+=4;var l=n.readUshort(r,e);e+=2;var c=n.readUshort(r,e);e+=2;var _=n.readUshort(r,e);return e+=2,s.scriptList=i._lctf.readScriptList(r,f+l),s.featureList=i._lctf.readFeatureList(r,f+c),s.lookupList=i._lctf.readLookupList(r,f+_,t),s},i._lctf.readLookupList=function(r,e,o){var a=i._bin,t=e,n=[],s=a.readUshort(r,e);e+=2;for(var f=0;f<s;f++){var l=a.readUshort(r,e);e+=2;var c=i._lctf.readLookupTable(r,t+l,o);n.push(c)}return n},i._lctf.readLookupTable=function(r,e,o){var a=i._bin,t=e,n={tabs:[]};n.ltype=a.readUshort(r,e),e+=2,n.flag=a.readUshort(r,e),e+=2;var s=a.readUshort(r,e);e+=2;for(var f=n.ltype,l=0;l<s;l++){var c=a.readUshort(r,e);e+=2;var _=o(r,f,t+c,n);n.tabs.push(_)}return n},i._lctf.numOfOnes=function(r){for(var e=0,o=0;o<32;o++)(r>>>o&1)!=0&&e++;return e},i._lctf.readClassDef=function(r,e){var o=i._bin,a=[],t=o.readUshort(r,e);if(e+=2,t==1){var n=o.readUshort(r,e);e+=2;var s=o.readUshort(r,e);e+=2;for(var f=0;f<s;f++)a.push(n+f),a.push(n+f),a.push(o.readUshort(r,e)),e+=2}if(t==2){var l=o.readUshort(r,e);for(e+=2,f=0;f<l;f++)a.push(o.readUshort(r,e)),e+=2,a.push(o.readUshort(r,e)),e+=2,a.push(o.readUshort(r,e)),e+=2}return a},i._lctf.getInterval=function(r,e){for(var o=0;o<r.length;o+=3){var a=r[o],t=r[o+1];if(r[o+2],a<=e&&e<=t)return o}return-1},i._lctf.readCoverage=function(r,e){var o=i._bin,a={};a.fmt=o.readUshort(r,e),e+=2;var t=o.readUshort(r,e);return e+=2,a.fmt==1&&(a.tab=o.readUshorts(r,e,t)),a.fmt==2&&(a.tab=o.readUshorts(r,e,3*t)),a},i._lctf.coverageIndex=function(r,e){var o=r.tab;if(r.fmt==1)return o.indexOf(e);if(r.fmt==2){var a=i._lctf.getInterval(o,e);if(a!=-1)return o[a+2]+(e-o[a])}return-1},i._lctf.readFeatureList=function(r,e){var o=i._bin,a=e,t=[],n=o.readUshort(r,e);e+=2;for(var s=0;s<n;s++){var f=o.readASCII(r,e,4);e+=4;var l=o.readUshort(r,e);e+=2;var c=i._lctf.readFeatureTable(r,a+l);c.tag=f.trim(),t.push(c)}return t},i._lctf.readFeatureTable=function(r,e){var o=i._bin,a=e,t={},n=o.readUshort(r,e);e+=2,n>0&&(t.featureParams=a+n);var s=o.readUshort(r,e);e+=2,t.tab=[];for(var f=0;f<s;f++)t.tab.push(o.readUshort(r,e+2*f));return t},i._lctf.readScriptList=function(r,e){var o=i._bin,a=e,t={},n=o.readUshort(r,e);e+=2;for(var s=0;s<n;s++){var f=o.readASCII(r,e,4);e+=4;var l=o.readUshort(r,e);e+=2,t[f.trim()]=i._lctf.readScriptTable(r,a+l)}return t},i._lctf.readScriptTable=function(r,e){var o=i._bin,a=e,t={},n=o.readUshort(r,e);e+=2,t.default=i._lctf.readLangSysTable(r,a+n);var s=o.readUshort(r,e);e+=2;for(var f=0;f<s;f++){var l=o.readASCII(r,e,4);e+=4;var c=o.readUshort(r,e);e+=2,t[l.trim()]=i._lctf.readLangSysTable(r,a+c)}return t},i._lctf.readLangSysTable=function(r,e){var o=i._bin,a={};o.readUshort(r,e),e+=2,a.reqFeature=o.readUshort(r,e),e+=2;var t=o.readUshort(r,e);return e+=2,a.features=o.readUshorts(r,e,t),a},i.CFF={},i.CFF.parse=function(r,e,o){var a=i._bin;(r=new Uint8Array(r.buffer,e,o))[e=0],r[++e],r[++e],r[++e],e++;var t=[];e=i.CFF.readIndex(r,e,t);for(var n=[],s=0;s<t.length-1;s++)n.push(a.readASCII(r,e+t[s],t[s+1]-t[s]));e+=t[t.length-1];var f=[];e=i.CFF.readIndex(r,e,f);var l=[];for(s=0;s<f.length-1;s++)l.push(i.CFF.readDict(r,e+f[s],e+f[s+1]));e+=f[f.length-1];var c=l[0],_=[];e=i.CFF.readIndex(r,e,_);var U=[];for(s=0;s<_.length-1;s++)U.push(a.readASCII(r,e+_[s],_[s+1]-_[s]));if(e+=_[_.length-1],i.CFF.readSubrs(r,e,c),c.CharStrings){e=c.CharStrings,_=[],e=i.CFF.readIndex(r,e,_);var g=[];for(s=0;s<_.length-1;s++)g.push(a.readBytes(r,e+_[s],_[s+1]-_[s]));c.CharStrings=g}if(c.ROS){e=c.FDArray;var p=[];for(e=i.CFF.readIndex(r,e,p),c.FDArray=[],s=0;s<p.length-1;s++){var h=i.CFF.readDict(r,e+p[s],e+p[s+1]);i.CFF._readFDict(r,h,U),c.FDArray.push(h)}e+=p[p.length-1],e=c.FDSelect,c.FDSelect=[];var y=r[e];if(e++,y!=3)throw y;var d=a.readUshort(r,e);for(e+=2,s=0;s<d+1;s++)c.FDSelect.push(a.readUshort(r,e),r[e+2]),e+=3}return c.Encoding&&(c.Encoding=i.CFF.readEncoding(r,c.Encoding,c.CharStrings.length)),c.charset&&(c.charset=i.CFF.readCharset(r,c.charset,c.CharStrings.length)),i.CFF._readFDict(r,c,U),c},i.CFF._readFDict=function(r,e,o){var a;for(var t in e.Private&&(a=e.Private[1],e.Private=i.CFF.readDict(r,a,a+e.Private[0]),e.Private.Subrs&&i.CFF.readSubrs(r,a+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(t)!=-1&&(e[t]=o[e[t]-426+35])},i.CFF.readSubrs=function(r,e,o){var a=i._bin,t=[];e=i.CFF.readIndex(r,e,t);var n,s=t.length;n=s<1240?107:s<33900?1131:32768,o.Bias=n,o.Subrs=[];for(var f=0;f<t.length-1;f++)o.Subrs.push(a.readBytes(r,e+t[f],t[f+1]-t[f]))},i.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],i.CFF.glyphByUnicode=function(r,e){for(var o=0;o<r.charset.length;o++)if(r.charset[o]==e)return o;return-1},i.CFF.glyphBySE=function(r,e){return e<0||e>255?-1:i.CFF.glyphByUnicode(r,i.CFF.tableSE[e])},i.CFF.readEncoding=function(r,e,o){i._bin;var a=[".notdef"],t=r[e];if(e++,t!=0)throw"error: unknown encoding format: "+t;var n=r[e];e++;for(var s=0;s<n;s++)a.push(r[e+s]);return a},i.CFF.readCharset=function(r,e,o){var a=i._bin,t=[".notdef"],n=r[e];if(e++,n==0)for(var s=0;s<o;s++){var f=a.readUshort(r,e);e+=2,t.push(f)}else{if(n!=1&&n!=2)throw"error: format: "+n;for(;t.length<o;){f=a.readUshort(r,e),e+=2;var l=0;for(n==1?(l=r[e],e++):(l=a.readUshort(r,e),e+=2),s=0;s<=l;s++)t.push(f),f++}}return t},i.CFF.readIndex=function(r,e,o){var a=i._bin,t=a.readUshort(r,e)+1,n=r[e+=2];if(e++,n==1)for(var s=0;s<t;s++)o.push(r[e+s]);else if(n==2)for(s=0;s<t;s++)o.push(a.readUshort(r,e+2*s));else if(n==3)for(s=0;s<t;s++)o.push(16777215&a.readUint(r,e+3*s-1));else if(t!=1)throw"unsupported offset size: "+n+", count: "+t;return(e+=t*n)-1},i.CFF.getCharString=function(r,e,o){var a=i._bin,t=r[e],n=r[e+1];r[e+2],r[e+3],r[e+4];var s=1,f=null,l=null;t<=20&&(f=t,s=1),t==12&&(f=100*t+n,s=2),21<=t&&t<=27&&(f=t,s=1),t==28&&(l=a.readShort(r,e+1),s=3),29<=t&&t<=31&&(f=t,s=1),32<=t&&t<=246&&(l=t-139,s=1),247<=t&&t<=250&&(l=256*(t-247)+n+108,s=2),251<=t&&t<=254&&(l=256*-(t-251)-n-108,s=2),t==255&&(l=a.readInt(r,e+1)/65535,s=5),o.val=l!=null?l:"o"+f,o.size=s},i.CFF.readCharString=function(r,e,o){for(var a=e+o,t=i._bin,n=[];e<a;){var s=r[e],f=r[e+1];r[e+2],r[e+3],r[e+4];var l=1,c=null,_=null;s<=20&&(c=s,l=1),s==12&&(c=100*s+f,l=2),s!=19&&s!=20||(c=s,l=2),21<=s&&s<=27&&(c=s,l=1),s==28&&(_=t.readShort(r,e+1),l=3),29<=s&&s<=31&&(c=s,l=1),32<=s&&s<=246&&(_=s-139,l=1),247<=s&&s<=250&&(_=256*(s-247)+f+108,l=2),251<=s&&s<=254&&(_=256*-(s-251)-f-108,l=2),s==255&&(_=t.readInt(r,e+1)/65535,l=5),n.push(_!=null?_:"o"+c),e+=l}return n},i.CFF.readDict=function(r,e,o){for(var a=i._bin,t={},n=[];e<o;){var s=r[e],f=r[e+1];r[e+2],r[e+3],r[e+4];var l=1,c=null,_=null;if(s==28&&(_=a.readShort(r,e+1),l=3),s==29&&(_=a.readInt(r,e+1),l=5),32<=s&&s<=246&&(_=s-139,l=1),247<=s&&s<=250&&(_=256*(s-247)+f+108,l=2),251<=s&&s<=254&&(_=256*-(s-251)-f-108,l=2),s==255)throw _=a.readInt(r,e+1)/65535,l=5,"unknown number";if(s==30){var U=[];for(l=1;;){var g=r[e+l];l++;var p=g>>4,h=15&g;if(p!=15&&U.push(p),h!=15&&U.push(h),h==15)break}for(var y="",d=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],b=0;b<U.length;b++)y+=d[U[b]];_=parseFloat(y)}s<=21&&(c=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],l=1,s==12&&(c=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],l=2)),c!=null?(t[c]=n.length==1?n[0]:n,n=[]):n.push(_),e+=l}return t},i.cmap={},i.cmap.parse=function(r,e,o){r=new Uint8Array(r.buffer,e,o),e=0;var a=i._bin,t={};a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2;var s=[];t.tables=[];for(var f=0;f<n;f++){var l=a.readUshort(r,e);e+=2;var c=a.readUshort(r,e);e+=2;var _=a.readUint(r,e);e+=4;var U="p"+l+"e"+c,g=s.indexOf(_);if(g==-1){var p;g=t.tables.length,s.push(_);var h=a.readUshort(r,_);h==0?p=i.cmap.parse0(r,_):h==4?p=i.cmap.parse4(r,_):h==6?p=i.cmap.parse6(r,_):h==12?p=i.cmap.parse12(r,_):console.debug("unknown format: "+h,l,c,_),t.tables.push(p)}if(t[U]!=null)throw"multiple tables for one platform+encoding";t[U]=g}return t},i.cmap.parse0=function(r,e){var o=i._bin,a={};a.format=o.readUshort(r,e),e+=2;var t=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2,a.map=[];for(var n=0;n<t-6;n++)a.map.push(r[e+n]);return a},i.cmap.parse4=function(r,e){var o=i._bin,a=e,t={};t.format=o.readUshort(r,e),e+=2;var n=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2;var s=o.readUshort(r,e);e+=2;var f=s/2;t.searchRange=o.readUshort(r,e),e+=2,t.entrySelector=o.readUshort(r,e),e+=2,t.rangeShift=o.readUshort(r,e),e+=2,t.endCount=o.readUshorts(r,e,f),e+=2*f,e+=2,t.startCount=o.readUshorts(r,e,f),e+=2*f,t.idDelta=[];for(var l=0;l<f;l++)t.idDelta.push(o.readShort(r,e)),e+=2;for(t.idRangeOffset=o.readUshorts(r,e,f),e+=2*f,t.glyphIdArray=[];e<a+n;)t.glyphIdArray.push(o.readUshort(r,e)),e+=2;return t},i.cmap.parse6=function(r,e){var o=i._bin,a={};a.format=o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,a.firstCode=o.readUshort(r,e),e+=2;var t=o.readUshort(r,e);e+=2,a.glyphIdArray=[];for(var n=0;n<t;n++)a.glyphIdArray.push(o.readUshort(r,e)),e+=2;return a},i.cmap.parse12=function(r,e){var o=i._bin,a={};a.format=o.readUshort(r,e),e+=2,e+=2,o.readUint(r,e),e+=4,o.readUint(r,e),e+=4;var t=o.readUint(r,e);e+=4,a.groups=[];for(var n=0;n<t;n++){var s=e+12*n,f=o.readUint(r,s+0),l=o.readUint(r,s+4),c=o.readUint(r,s+8);a.groups.push([f,l,c])}return a},i.glyf={},i.glyf.parse=function(r,e,o,a){for(var t=[],n=0;n<a.maxp.numGlyphs;n++)t.push(null);return t},i.glyf._parseGlyf=function(r,e){var o=i._bin,a=r._data,t=i._tabOffset(a,"glyf",r._offset)+r.loca[e];if(r.loca[e]==r.loca[e+1])return null;var n={};if(n.noc=o.readShort(a,t),t+=2,n.xMin=o.readShort(a,t),t+=2,n.yMin=o.readShort(a,t),t+=2,n.xMax=o.readShort(a,t),t+=2,n.yMax=o.readShort(a,t),t+=2,n.xMin>=n.xMax||n.yMin>=n.yMax)return null;if(n.noc>0){n.endPts=[];for(var s=0;s<n.noc;s++)n.endPts.push(o.readUshort(a,t)),t+=2;var f=o.readUshort(a,t);if(t+=2,a.length-t<f)return null;n.instructions=o.readBytes(a,t,f),t+=f;var l=n.endPts[n.noc-1]+1;for(n.flags=[],s=0;s<l;s++){var c=a[t];if(t++,n.flags.push(c),(8&c)!=0){var _=a[t];t++;for(var U=0;U<_;U++)n.flags.push(c),s++}}for(n.xs=[],s=0;s<l;s++){var g=(2&n.flags[s])!=0,p=(16&n.flags[s])!=0;g?(n.xs.push(p?a[t]:-a[t]),t++):p?n.xs.push(0):(n.xs.push(o.readShort(a,t)),t+=2)}for(n.ys=[],s=0;s<l;s++)g=(4&n.flags[s])!=0,p=(32&n.flags[s])!=0,g?(n.ys.push(p?a[t]:-a[t]),t++):p?n.ys.push(0):(n.ys.push(o.readShort(a,t)),t+=2);var h=0,y=0;for(s=0;s<l;s++)h+=n.xs[s],y+=n.ys[s],n.xs[s]=h,n.ys[s]=y}else{var d;n.parts=[];do{d=o.readUshort(a,t),t+=2;var b={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(n.parts.push(b),b.glyphIndex=o.readUshort(a,t),t+=2,1&d){var w=o.readShort(a,t);t+=2;var A=o.readShort(a,t);t+=2}else w=o.readInt8(a,t),t++,A=o.readInt8(a,t),t++;2&d?(b.m.tx=w,b.m.ty=A):(b.p1=w,b.p2=A),8&d?(b.m.a=b.m.d=o.readF2dot14(a,t),t+=2):64&d?(b.m.a=o.readF2dot14(a,t),t+=2,b.m.d=o.readF2dot14(a,t),t+=2):128&d&&(b.m.a=o.readF2dot14(a,t),t+=2,b.m.b=o.readF2dot14(a,t),t+=2,b.m.c=o.readF2dot14(a,t),t+=2,b.m.d=o.readF2dot14(a,t),t+=2)}while(32&d);if(256&d){var x=o.readUshort(a,t);for(t+=2,n.instr=[],s=0;s<x;s++)n.instr.push(a[t]),t++}}return n},i.GPOS={},i.GPOS.parse=function(r,e,o,a){return i._lctf.parse(r,e,o,a,i.GPOS.subt)},i.GPOS.subt=function(r,e,o,a){var t=i._bin,n=o,s={};if(s.fmt=t.readUshort(r,o),o+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var f=t.readUshort(r,o);o+=2,s.coverage=i._lctf.readCoverage(r,f+n)}if(e==1&&s.fmt==1){var l=t.readUshort(r,o);o+=2;var c=i._lctf.numOfOnes(l);l!=0&&(s.pos=i.GPOS.readValueRecord(r,o,l))}else if(e==2&&s.fmt>=1&&s.fmt<=2){l=t.readUshort(r,o),o+=2;var _=t.readUshort(r,o);o+=2,c=i._lctf.numOfOnes(l);var U=i._lctf.numOfOnes(_);if(s.fmt==1){s.pairsets=[];var g=t.readUshort(r,o);o+=2;for(var p=0;p<g;p++){var h=n+t.readUshort(r,o);o+=2;var y=t.readUshort(r,h);h+=2;for(var d=[],b=0;b<y;b++){var w=t.readUshort(r,h);h+=2,l!=0&&(S=i.GPOS.readValueRecord(r,h,l),h+=2*c),_!=0&&(D=i.GPOS.readValueRecord(r,h,_),h+=2*U),d.push({gid2:w,val1:S,val2:D})}s.pairsets.push(d)}}if(s.fmt==2){var A=t.readUshort(r,o);o+=2;var x=t.readUshort(r,o);o+=2;var N=t.readUshort(r,o);o+=2;var Z=t.readUshort(r,o);for(o+=2,s.classDef1=i._lctf.readClassDef(r,n+A),s.classDef2=i._lctf.readClassDef(r,n+x),s.matrix=[],p=0;p<N;p++){var H=[];for(b=0;b<Z;b++){var S=null,D=null;l!=0&&(S=i.GPOS.readValueRecord(r,o,l),o+=2*c),_!=0&&(D=i.GPOS.readValueRecord(r,o,_),o+=2*U),H.push({val1:S,val2:D})}s.matrix.push(H)}}}else{if(e==9&&s.fmt==1){var C=t.readUshort(r,o);o+=2;var Q=t.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=C;else if(a.ltype!=C)throw"invalid extension substitution";return i.GPOS.subt(r,a.ltype,n+Q)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},i.GPOS.readValueRecord=function(r,e,o){var a=i._bin,t=[];return t.push(1&o?a.readShort(r,e):0),e+=1&o?2:0,t.push(2&o?a.readShort(r,e):0),e+=2&o?2:0,t.push(4&o?a.readShort(r,e):0),e+=4&o?2:0,t.push(8&o?a.readShort(r,e):0),e+=8&o?2:0,t},i.GSUB={},i.GSUB.parse=function(r,e,o,a){return i._lctf.parse(r,e,o,a,i.GSUB.subt)},i.GSUB.subt=function(r,e,o,a){var t=i._bin,n=o,s={};if(s.fmt=t.readUshort(r,o),o+=2,e!=1&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var f=t.readUshort(r,o);o+=2,s.coverage=i._lctf.readCoverage(r,n+f)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=t.readShort(r,o),o+=2;else if(s.fmt==2){var l=t.readUshort(r,o);o+=2,s.newg=t.readUshorts(r,o,l),o+=2*s.newg.length}}else if(e==4){s.vals=[],l=t.readUshort(r,o),o+=2;for(var c=0;c<l;c++){var _=t.readUshort(r,o);o+=2,s.vals.push(i.GSUB.readLigatureSet(r,n+_))}}else if(e==5&&s.fmt==2){if(s.fmt==2){var U=t.readUshort(r,o);o+=2,s.cDef=i._lctf.readClassDef(r,n+U),s.scset=[];var g=t.readUshort(r,o);for(o+=2,c=0;c<g;c++){var p=t.readUshort(r,o);o+=2,s.scset.push(p==0?null:i.GSUB.readSubClassSet(r,n+p))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(c=0;c<3;c++){l=t.readUshort(r,o),o+=2;for(var h=[],y=0;y<l;y++)h.push(i._lctf.readCoverage(r,n+t.readUshort(r,o+2*y)));o+=2*l,c==0&&(s.backCvg=h),c==1&&(s.inptCvg=h),c==2&&(s.ahedCvg=h)}l=t.readUshort(r,o),o+=2,s.lookupRec=i.GSUB.readSubstLookupRecords(r,o,l)}}else{if(e==7&&s.fmt==1){var d=t.readUshort(r,o);o+=2;var b=t.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=d;else if(a.ltype!=d)throw"invalid extension substitution";return i.GSUB.subt(r,a.ltype,n+b)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},i.GSUB.readSubClassSet=function(r,e){var o=i._bin.readUshort,a=e,t=[],n=o(r,e);e+=2;for(var s=0;s<n;s++){var f=o(r,e);e+=2,t.push(i.GSUB.readSubClassRule(r,a+f))}return t},i.GSUB.readSubClassRule=function(r,e){var o=i._bin.readUshort,a={},t=o(r,e),n=o(r,e+=2);e+=2,a.input=[];for(var s=0;s<t-1;s++)a.input.push(o(r,e)),e+=2;return a.substLookupRecords=i.GSUB.readSubstLookupRecords(r,e,n),a},i.GSUB.readSubstLookupRecords=function(r,e,o){for(var a=i._bin.readUshort,t=[],n=0;n<o;n++)t.push(a(r,e),a(r,e+2)),e+=4;return t},i.GSUB.readChainSubClassSet=function(r,e){var o=i._bin,a=e,t=[],n=o.readUshort(r,e);e+=2;for(var s=0;s<n;s++){var f=o.readUshort(r,e);e+=2,t.push(i.GSUB.readChainSubClassRule(r,a+f))}return t},i.GSUB.readChainSubClassRule=function(r,e){for(var o=i._bin,a={},t=["backtrack","input","lookahead"],n=0;n<t.length;n++){var s=o.readUshort(r,e);e+=2,n==1&&s--,a[t[n]]=o.readUshorts(r,e,s),e+=2*a[t[n]].length}return s=o.readUshort(r,e),e+=2,a.subst=o.readUshorts(r,e,2*s),e+=2*a.subst.length,a},i.GSUB.readLigatureSet=function(r,e){var o=i._bin,a=e,t=[],n=o.readUshort(r,e);e+=2;for(var s=0;s<n;s++){var f=o.readUshort(r,e);e+=2,t.push(i.GSUB.readLigature(r,a+f))}return t},i.GSUB.readLigature=function(r,e){var o=i._bin,a={chain:[]};a.nglyph=o.readUshort(r,e),e+=2;var t=o.readUshort(r,e);e+=2;for(var n=0;n<t-1;n++)a.chain.push(o.readUshort(r,e)),e+=2;return a},i.head={},i.head.parse=function(r,e,o){var a=i._bin,t={};return a.readFixed(r,e),e+=4,t.fontRevision=a.readFixed(r,e),e+=4,a.readUint(r,e),e+=4,a.readUint(r,e),e+=4,t.flags=a.readUshort(r,e),e+=2,t.unitsPerEm=a.readUshort(r,e),e+=2,t.created=a.readUint64(r,e),e+=8,t.modified=a.readUint64(r,e),e+=8,t.xMin=a.readShort(r,e),e+=2,t.yMin=a.readShort(r,e),e+=2,t.xMax=a.readShort(r,e),e+=2,t.yMax=a.readShort(r,e),e+=2,t.macStyle=a.readUshort(r,e),e+=2,t.lowestRecPPEM=a.readUshort(r,e),e+=2,t.fontDirectionHint=a.readShort(r,e),e+=2,t.indexToLocFormat=a.readShort(r,e),e+=2,t.glyphDataFormat=a.readShort(r,e),e+=2,t},i.hhea={},i.hhea.parse=function(r,e,o){var a=i._bin,t={};return a.readFixed(r,e),e+=4,t.ascender=a.readShort(r,e),e+=2,t.descender=a.readShort(r,e),e+=2,t.lineGap=a.readShort(r,e),e+=2,t.advanceWidthMax=a.readUshort(r,e),e+=2,t.minLeftSideBearing=a.readShort(r,e),e+=2,t.minRightSideBearing=a.readShort(r,e),e+=2,t.xMaxExtent=a.readShort(r,e),e+=2,t.caretSlopeRise=a.readShort(r,e),e+=2,t.caretSlopeRun=a.readShort(r,e),e+=2,t.caretOffset=a.readShort(r,e),e+=2,e+=8,t.metricDataFormat=a.readShort(r,e),e+=2,t.numberOfHMetrics=a.readUshort(r,e),e+=2,t},i.hmtx={},i.hmtx.parse=function(r,e,o,a){for(var t=i._bin,n={aWidth:[],lsBearing:[]},s=0,f=0,l=0;l<a.maxp.numGlyphs;l++)l<a.hhea.numberOfHMetrics&&(s=t.readUshort(r,e),e+=2,f=t.readShort(r,e),e+=2),n.aWidth.push(s),n.lsBearing.push(f);return n},i.kern={},i.kern.parse=function(r,e,o,a){var t=i._bin,n=t.readUshort(r,e);if(e+=2,n==1)return i.kern.parseV1(r,e-2,o,a);var s=t.readUshort(r,e);e+=2;for(var f={glyph1:[],rval:[]},l=0;l<s;l++){e+=2,o=t.readUshort(r,e),e+=2;var c=t.readUshort(r,e);e+=2;var _=c>>>8;if((_&=15)!=0)throw"unknown kern table format: "+_;e=i.kern.readFormat0(r,e,f)}return f},i.kern.parseV1=function(r,e,o,a){var t=i._bin;t.readFixed(r,e),e+=4;var n=t.readUint(r,e);e+=4;for(var s={glyph1:[],rval:[]},f=0;f<n;f++){t.readUint(r,e),e+=4;var l=t.readUshort(r,e);e+=2,t.readUshort(r,e),e+=2;var c=l>>>8;if((c&=15)!=0)throw"unknown kern table format: "+c;e=i.kern.readFormat0(r,e,s)}return s},i.kern.readFormat0=function(r,e,o){var a=i._bin,t=-1,n=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2;for(var s=0;s<n;s++){var f=a.readUshort(r,e);e+=2;var l=a.readUshort(r,e);e+=2;var c=a.readShort(r,e);e+=2,f!=t&&(o.glyph1.push(f),o.rval.push({glyph2:[],vals:[]}));var _=o.rval[o.rval.length-1];_.glyph2.push(l),_.vals.push(c),t=f}return e},i.loca={},i.loca.parse=function(r,e,o,a){var t=i._bin,n=[],s=a.head.indexToLocFormat,f=a.maxp.numGlyphs+1;if(s==0)for(var l=0;l<f;l++)n.push(t.readUshort(r,e+(l<<1))<<1);if(s==1)for(l=0;l<f;l++)n.push(t.readUint(r,e+(l<<2)));return n},i.maxp={},i.maxp.parse=function(r,e,o){var a=i._bin,t={},n=a.readUint(r,e);return e+=4,t.numGlyphs=a.readUshort(r,e),e+=2,n==65536&&(t.maxPoints=a.readUshort(r,e),e+=2,t.maxContours=a.readUshort(r,e),e+=2,t.maxCompositePoints=a.readUshort(r,e),e+=2,t.maxCompositeContours=a.readUshort(r,e),e+=2,t.maxZones=a.readUshort(r,e),e+=2,t.maxTwilightPoints=a.readUshort(r,e),e+=2,t.maxStorage=a.readUshort(r,e),e+=2,t.maxFunctionDefs=a.readUshort(r,e),e+=2,t.maxInstructionDefs=a.readUshort(r,e),e+=2,t.maxStackElements=a.readUshort(r,e),e+=2,t.maxSizeOfInstructions=a.readUshort(r,e),e+=2,t.maxComponentElements=a.readUshort(r,e),e+=2,t.maxComponentDepth=a.readUshort(r,e),e+=2),t},i.name={},i.name.parse=function(r,e,o){var a=i._bin,t={};a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2,a.readUshort(r,e);for(var s,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],l=e+=2,c=0;c<n;c++){var _=a.readUshort(r,e);e+=2;var U=a.readUshort(r,e);e+=2;var g=a.readUshort(r,e);e+=2;var p=a.readUshort(r,e);e+=2;var h=a.readUshort(r,e);e+=2;var y=a.readUshort(r,e);e+=2;var d,b=f[p],w=l+12*n+y;if(_==0)d=a.readUnicode(r,w,h/2);else if(_==3&&U==0)d=a.readUnicode(r,w,h/2);else if(U==0)d=a.readASCII(r,w,h);else if(U==1)d=a.readUnicode(r,w,h/2);else if(U==3)d=a.readUnicode(r,w,h/2);else{if(_!=1)throw"unknown encoding "+U+", platformID: "+_;d=a.readASCII(r,w,h),console.debug("reading unknown MAC encoding "+U+" as ASCII")}var A="p"+_+","+g.toString(16);t[A]==null&&(t[A]={}),t[A][b!==void 0?b:p]=d,t[A]._lang=g}for(var x in t)if(t[x].postScriptName!=null&&t[x]._lang==1033)return t[x];for(var x in t)if(t[x].postScriptName!=null&&t[x]._lang==0)return t[x];for(var x in t)if(t[x].postScriptName!=null&&t[x]._lang==3084)return t[x];for(var x in t)if(t[x].postScriptName!=null)return t[x];for(var x in t){s=x;break}return console.debug("returning name table with languageID "+t[s]._lang),t[s]},i["OS/2"]={},i["OS/2"].parse=function(r,e,o){var a=i._bin.readUshort(r,e);e+=2;var t={};if(a==0)i["OS/2"].version0(r,e,t);else if(a==1)i["OS/2"].version1(r,e,t);else if(a==2||a==3||a==4)i["OS/2"].version2(r,e,t);else{if(a!=5)throw"unknown OS/2 table version: "+a;i["OS/2"].version5(r,e,t)}return t},i["OS/2"].version0=function(r,e,o){var a=i._bin;return o.xAvgCharWidth=a.readShort(r,e),e+=2,o.usWeightClass=a.readUshort(r,e),e+=2,o.usWidthClass=a.readUshort(r,e),e+=2,o.fsType=a.readUshort(r,e),e+=2,o.ySubscriptXSize=a.readShort(r,e),e+=2,o.ySubscriptYSize=a.readShort(r,e),e+=2,o.ySubscriptXOffset=a.readShort(r,e),e+=2,o.ySubscriptYOffset=a.readShort(r,e),e+=2,o.ySuperscriptXSize=a.readShort(r,e),e+=2,o.ySuperscriptYSize=a.readShort(r,e),e+=2,o.ySuperscriptXOffset=a.readShort(r,e),e+=2,o.ySuperscriptYOffset=a.readShort(r,e),e+=2,o.yStrikeoutSize=a.readShort(r,e),e+=2,o.yStrikeoutPosition=a.readShort(r,e),e+=2,o.sFamilyClass=a.readShort(r,e),e+=2,o.panose=a.readBytes(r,e,10),e+=10,o.ulUnicodeRange1=a.readUint(r,e),e+=4,o.ulUnicodeRange2=a.readUint(r,e),e+=4,o.ulUnicodeRange3=a.readUint(r,e),e+=4,o.ulUnicodeRange4=a.readUint(r,e),e+=4,o.achVendID=[a.readInt8(r,e),a.readInt8(r,e+1),a.readInt8(r,e+2),a.readInt8(r,e+3)],e+=4,o.fsSelection=a.readUshort(r,e),e+=2,o.usFirstCharIndex=a.readUshort(r,e),e+=2,o.usLastCharIndex=a.readUshort(r,e),e+=2,o.sTypoAscender=a.readShort(r,e),e+=2,o.sTypoDescender=a.readShort(r,e),e+=2,o.sTypoLineGap=a.readShort(r,e),e+=2,o.usWinAscent=a.readUshort(r,e),e+=2,o.usWinDescent=a.readUshort(r,e),e+=2},i["OS/2"].version1=function(r,e,o){var a=i._bin;return e=i["OS/2"].version0(r,e,o),o.ulCodePageRange1=a.readUint(r,e),e+=4,o.ulCodePageRange2=a.readUint(r,e),e+=4},i["OS/2"].version2=function(r,e,o){var a=i._bin;return e=i["OS/2"].version1(r,e,o),o.sxHeight=a.readShort(r,e),e+=2,o.sCapHeight=a.readShort(r,e),e+=2,o.usDefault=a.readUshort(r,e),e+=2,o.usBreak=a.readUshort(r,e),e+=2,o.usMaxContext=a.readUshort(r,e),e+=2},i["OS/2"].version5=function(r,e,o){var a=i._bin;return e=i["OS/2"].version2(r,e,o),o.usLowerOpticalPointSize=a.readUshort(r,e),e+=2,o.usUpperOpticalPointSize=a.readUshort(r,e),e+=2},i.post={},i.post.parse=function(r,e,o){var a=i._bin,t={};return t.version=a.readFixed(r,e),e+=4,t.italicAngle=a.readFixed(r,e),e+=4,t.underlinePosition=a.readShort(r,e),e+=2,t.underlineThickness=a.readShort(r,e),e+=2,t},i==null&&(i={}),i.U==null&&(i.U={}),i.U.codeToGlyph=function(r,e){var o=r.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var t=o.tables[a];if(t.format==0)return e>=t.map.length?0:t.map[e];if(t.format==4){for(var n=-1,s=0;s<t.endCount.length;s++)if(e<=t.endCount[s]){n=s;break}return n==-1||t.startCount[n]>e?0:65535&(t.idRangeOffset[n]!=0?t.glyphIdArray[e-t.startCount[n]+(t.idRangeOffset[n]>>1)-(t.idRangeOffset.length-n)]:e+t.idDelta[n])}if(t.format==12){if(e>t.groups[t.groups.length-1][1])return 0;for(s=0;s<t.groups.length;s++){var f=t.groups[s];if(f[0]<=e&&e<=f[1])return f[2]+(e-f[0])}return 0}throw"unknown cmap table format "+t.format},i.U.glyphToPath=function(r,e){var o={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[e]){var a=r.SVG.entries[e];return a==null?o:(typeof a=="string"&&(a=i.SVG.toPath(a),r.SVG.entries[e]=a),a)}if(r.CFF){var t={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},n=r.CFF,s=r.CFF.Private;if(n.ROS){for(var f=0;n.FDSelect[f+2]<=e;)f+=2;s=n.FDArray[n.FDSelect[f+1]].Private}i.U._drawCFF(r.CFF.CharStrings[e],t,n,s,o)}else r.glyf&&i.U._drawGlyf(e,r,o);return o},i.U._drawGlyf=function(r,e,o){var a=e.glyf[r];a==null&&(a=e.glyf[r]=i.glyf._parseGlyf(e,r)),a!=null&&(a.noc>-1?i.U._simpleGlyph(a,o):i.U._compoGlyph(a,e,o))},i.U._simpleGlyph=function(r,e){for(var o=0;o<r.noc;o++){for(var a=o==0?0:r.endPts[o-1]+1,t=r.endPts[o],n=a;n<=t;n++){var s=n==a?t:n-1,f=n==t?a:n+1,l=1&r.flags[n],c=1&r.flags[s],_=1&r.flags[f],U=r.xs[n],g=r.ys[n];if(n==a)if(l){if(!c){i.U.P.moveTo(e,U,g);continue}i.U.P.moveTo(e,r.xs[s],r.ys[s])}else c?i.U.P.moveTo(e,r.xs[s],r.ys[s]):i.U.P.moveTo(e,(r.xs[s]+U)/2,(r.ys[s]+g)/2);l?c&&i.U.P.lineTo(e,U,g):_?i.U.P.qcurveTo(e,U,g,r.xs[f],r.ys[f]):i.U.P.qcurveTo(e,U,g,(U+r.xs[f])/2,(g+r.ys[f])/2)}i.U.P.closePath(e)}},i.U._compoGlyph=function(r,e,o){for(var a=0;a<r.parts.length;a++){var t={cmds:[],crds:[]},n=r.parts[a];i.U._drawGlyf(n.glyphIndex,e,t);for(var s=n.m,f=0;f<t.crds.length;f+=2){var l=t.crds[f],c=t.crds[f+1];o.crds.push(l*s.a+c*s.b+s.tx),o.crds.push(l*s.c+c*s.d+s.ty)}for(f=0;f<t.cmds.length;f++)o.cmds.push(t.cmds[f])}},i.U._getGlyphClass=function(r,e){var o=i._lctf.getInterval(e,r);return o==-1?0:e[o+2]},i.U.getPairAdjustment=function(r,e,o){var a=0,t=!1;if(r.GPOS)for(var n=r.GPOS,s=n.lookupList,f=n.featureList,l=[],c=0;c<f.length;c++){var _=f[c];if(_.tag=="kern"){t=!0;for(var U=0;U<_.tab.length;U++)if(!l[_.tab[U]]){l[_.tab[U]]=!0;for(var g=s[_.tab[U]],p=0;p<g.tabs.length;p++)if(g.tabs[p]!=null){var h,y=g.tabs[p];if((!y.coverage||(h=i._lctf.coverageIndex(y.coverage,e))!=-1)&&g.ltype!=1){if(g.ltype==2){var d;if(y.fmt==1){var b=y.pairsets[h];for(c=0;c<b.length;c++)b[c].gid2==o&&(d=b[c])}else if(y.fmt==2){var w=i.U._getGlyphClass(e,y.classDef1),A=i.U._getGlyphClass(o,y.classDef2);d=y.matrix[w][A]}d&&d.val1&&d.val1[2]&&(a+=d.val1[2]),d&&d.val2&&d.val2[0]&&(a+=d.val2[0])}}}}}}if(r.kern&&!t){var x=r.kern.glyph1.indexOf(e);if(x!=-1){var N=r.kern.rval[x].glyph2.indexOf(o);N!=-1&&(a+=r.kern.rval[x].vals[N])}}return a},i.U._applySubs=function(r,e,o,a){for(var t=r.length-e-1,n=0;n<o.tabs.length;n++)if(o.tabs[n]!=null){var s,f=o.tabs[n];if(!f.coverage||(s=i._lctf.coverageIndex(f.coverage,r[e]))!=-1){if(o.ltype==1)r[e],f.fmt==1?r[e]=r[e]+f.delta:r[e]=f.newg[s];else if(o.ltype==4)for(var l=f.vals[s],c=0;c<l.length;c++){var _=l[c],U=_.chain.length;if(!(U>t)){for(var g=!0,p=0,h=0;h<U;h++){for(;r[e+p+(1+h)]==-1;)p++;_.chain[h]!=r[e+p+(1+h)]&&(g=!1)}if(g){for(r[e]=_.nglyph,h=0;h<U+p;h++)r[e+h+1]=-1;break}}}else if(o.ltype==5&&f.fmt==2)for(var y=i._lctf.getInterval(f.cDef,r[e]),d=f.cDef[y+2],b=f.scset[d],w=0;w<b.length;w++){var A=b[w],x=A.input;if(!(x.length>t)){for(g=!0,h=0;h<x.length;h++){var N=i._lctf.getInterval(f.cDef,r[e+1+h]);if(y==-1&&f.cDef[N+2]!=x[h]){g=!1;break}}if(g){var Z=A.substLookupRecords;for(c=0;c<Z.length;c+=2)Z[c],Z[c+1]}}}else if(o.ltype==6&&f.fmt==3){if(!i.U._glsCovered(r,f.backCvg,e-f.backCvg.length)||!i.U._glsCovered(r,f.inptCvg,e)||!i.U._glsCovered(r,f.ahedCvg,e+f.inptCvg.length))continue;var H=f.lookupRec;for(w=0;w<H.length;w+=2){y=H[w];var S=a[H[w+1]];i.U._applySubs(r,e+y,S,a)}}}}},i.U._glsCovered=function(r,e,o){for(var a=0;a<e.length;a++)if(i._lctf.coverageIndex(e[a],r[o+a])==-1)return!1;return!0},i.U.glyphsToPath=function(r,e,o){for(var a={cmds:[],crds:[]},t=0,n=0;n<e.length;n++){var s=e[n];if(s!=-1){for(var f=n<e.length-1&&e[n+1]!=-1?e[n+1]:0,l=i.U.glyphToPath(r,s),c=0;c<l.crds.length;c+=2)a.crds.push(l.crds[c]+t),a.crds.push(l.crds[c+1]);for(o&&a.cmds.push(o),c=0;c<l.cmds.length;c++)a.cmds.push(l.cmds[c]);o&&a.cmds.push("X"),t+=r.hmtx.aWidth[s],n<e.length-1&&(t+=i.U.getPairAdjustment(r,s,f))}}return a},i.U.P={},i.U.P.moveTo=function(r,e,o){r.cmds.push("M"),r.crds.push(e,o)},i.U.P.lineTo=function(r,e,o){r.cmds.push("L"),r.crds.push(e,o)},i.U.P.curveTo=function(r,e,o,a,t,n,s){r.cmds.push("C"),r.crds.push(e,o,a,t,n,s)},i.U.P.qcurveTo=function(r,e,o,a,t){r.cmds.push("Q"),r.crds.push(e,o,a,t)},i.U.P.closePath=function(r){r.cmds.push("Z")},i.U._drawCFF=function(r,e,o,a,t){for(var n=e.stack,s=e.nStems,f=e.haveWidth,l=e.width,c=e.open,_=0,U=e.x,g=e.y,p=0,h=0,y=0,d=0,b=0,w=0,A=0,x=0,N=0,Z=0,H={val:0,size:0};_<r.length;){i.CFF.getCharString(r,_,H);var S=H.val;if(_+=H.size,S=="o1"||S=="o18")n.length%2!=0&&!f&&(l=n.shift()+a.nominalWidthX),s+=n.length>>1,n.length=0,f=!0;else if(S=="o3"||S=="o23")n.length%2!=0&&!f&&(l=n.shift()+a.nominalWidthX),s+=n.length>>1,n.length=0,f=!0;else if(S=="o4")n.length>1&&!f&&(l=n.shift()+a.nominalWidthX,f=!0),c&&i.U.P.closePath(t),g+=n.pop(),i.U.P.moveTo(t,U,g),c=!0;else if(S=="o5")for(;n.length>0;)U+=n.shift(),g+=n.shift(),i.U.P.lineTo(t,U,g);else if(S=="o6"||S=="o7")for(var D=n.length,C=S=="o6",Q=0;Q<D;Q++){var z=n.shift();C?U+=z:g+=z,C=!C,i.U.P.lineTo(t,U,g)}else if(S=="o8"||S=="o24"){D=n.length;for(var oe=0;oe+6<=D;)p=U+n.shift(),h=g+n.shift(),y=p+n.shift(),d=h+n.shift(),U=y+n.shift(),g=d+n.shift(),i.U.P.curveTo(t,p,h,y,d,U,g),oe+=6;S=="o24"&&(U+=n.shift(),g+=n.shift(),i.U.P.lineTo(t,U,g))}else{if(S=="o11")break;if(S=="o1234"||S=="o1235"||S=="o1236"||S=="o1237")S=="o1234"&&(h=g,y=(p=U+n.shift())+n.shift(),Z=d=h+n.shift(),w=d,x=g,U=(A=(b=(N=y+n.shift())+n.shift())+n.shift())+n.shift(),i.U.P.curveTo(t,p,h,y,d,N,Z),i.U.P.curveTo(t,b,w,A,x,U,g)),S=="o1235"&&(p=U+n.shift(),h=g+n.shift(),y=p+n.shift(),d=h+n.shift(),N=y+n.shift(),Z=d+n.shift(),b=N+n.shift(),w=Z+n.shift(),A=b+n.shift(),x=w+n.shift(),U=A+n.shift(),g=x+n.shift(),n.shift(),i.U.P.curveTo(t,p,h,y,d,N,Z),i.U.P.curveTo(t,b,w,A,x,U,g)),S=="o1236"&&(p=U+n.shift(),h=g+n.shift(),y=p+n.shift(),Z=d=h+n.shift(),w=d,A=(b=(N=y+n.shift())+n.shift())+n.shift(),x=w+n.shift(),U=A+n.shift(),i.U.P.curveTo(t,p,h,y,d,N,Z),i.U.P.curveTo(t,b,w,A,x,U,g)),S=="o1237"&&(p=U+n.shift(),h=g+n.shift(),y=p+n.shift(),d=h+n.shift(),N=y+n.shift(),Z=d+n.shift(),b=N+n.shift(),w=Z+n.shift(),A=b+n.shift(),x=w+n.shift(),Math.abs(A-U)>Math.abs(x-g)?U=A+n.shift():g=x+n.shift(),i.U.P.curveTo(t,p,h,y,d,N,Z),i.U.P.curveTo(t,b,w,A,x,U,g));else if(S=="o14"){if(n.length>0&&!f&&(l=n.shift()+o.nominalWidthX,f=!0),n.length==4){var ie=n.shift(),M=n.shift(),I=n.shift(),m=n.shift(),F=i.CFF.glyphBySE(o,I),L=i.CFF.glyphBySE(o,m);i.U._drawCFF(o.CharStrings[F],e,o,a,t),e.x=ie,e.y=M,i.U._drawCFF(o.CharStrings[L],e,o,a,t)}c&&(i.U.P.closePath(t),c=!1)}else if(S=="o19"||S=="o20")n.length%2!=0&&!f&&(l=n.shift()+a.nominalWidthX),s+=n.length>>1,n.length=0,f=!0,_+=s+7>>3;else if(S=="o21")n.length>2&&!f&&(l=n.shift()+a.nominalWidthX,f=!0),g+=n.pop(),U+=n.pop(),c&&i.U.P.closePath(t),i.U.P.moveTo(t,U,g),c=!0;else if(S=="o22")n.length>1&&!f&&(l=n.shift()+a.nominalWidthX,f=!0),U+=n.pop(),c&&i.U.P.closePath(t),i.U.P.moveTo(t,U,g),c=!0;else if(S=="o25"){for(;n.length>6;)U+=n.shift(),g+=n.shift(),i.U.P.lineTo(t,U,g);p=U+n.shift(),h=g+n.shift(),y=p+n.shift(),d=h+n.shift(),U=y+n.shift(),g=d+n.shift(),i.U.P.curveTo(t,p,h,y,d,U,g)}else if(S=="o26")for(n.length%2&&(U+=n.shift());n.length>0;)p=U,h=g+n.shift(),U=y=p+n.shift(),g=(d=h+n.shift())+n.shift(),i.U.P.curveTo(t,p,h,y,d,U,g);else if(S=="o27")for(n.length%2&&(g+=n.shift());n.length>0;)h=g,y=(p=U+n.shift())+n.shift(),d=h+n.shift(),U=y+n.shift(),g=d,i.U.P.curveTo(t,p,h,y,d,U,g);else if(S=="o10"||S=="o29"){var O=S=="o10"?a:o;if(n.length==0)console.debug("error: empty stack");else{var E=n.pop(),R=O.Subrs[E+O.Bias];e.x=U,e.y=g,e.nStems=s,e.haveWidth=f,e.width=l,e.open=c,i.U._drawCFF(R,e,o,a,t),U=e.x,g=e.y,s=e.nStems,f=e.haveWidth,l=e.width,c=e.open}}else if(S=="o30"||S=="o31"){var k=n.length,P=(oe=0,S=="o31");for(oe+=k-(D=-3&k);oe<D;)P?(h=g,y=(p=U+n.shift())+n.shift(),g=(d=h+n.shift())+n.shift(),D-oe==5?(U=y+n.shift(),oe++):U=y,P=!1):(p=U,h=g+n.shift(),y=p+n.shift(),d=h+n.shift(),U=y+n.shift(),D-oe==5?(g=d+n.shift(),oe++):g=d,P=!0),i.U.P.curveTo(t,p,h,y,d,U,g),oe+=4}else{if((S+"").charAt(0)=="o")throw console.debug("Unknown operation: "+S,r),S;n.push(S)}}}e.x=U,e.y=g,e.nStems=s,e.haveWidth=f,e.width=l,e.open=c};var T=i,v={Typr:T};return u.Typr=T,u.default=v,Object.defineProperty(u,"__esModule",{value:!0}),u}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function qn(){return function(u){var i=Uint8Array,T=Uint16Array,v=Uint32Array,r=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(S,D){for(var C=new T(31),Q=0;Q<31;++Q)C[Q]=D+=1<<S[Q-1];var z=new v(C[30]);for(Q=1;Q<30;++Q)for(var oe=C[Q];oe<C[Q+1];++oe)z[oe]=oe-C[Q]<<5|Q;return[C,z]},t=a(r,2),n=t[0],s=t[1];n[28]=258,s[258]=28;for(var f=a(e,0)[0],l=new T(32768),c=0;c<32768;++c){var _=(43690&c)>>>1|(21845&c)<<1;_=(61680&(_=(52428&_)>>>2|(13107&_)<<2))>>>4|(3855&_)<<4,l[c]=((65280&_)>>>8|(255&_)<<8)>>>1}var U=function(S,D,C){for(var Q=S.length,z=0,oe=new T(D);z<Q;++z)++oe[S[z]-1];var ie,M=new T(D);for(z=0;z<D;++z)M[z]=M[z-1]+oe[z-1]<<1;if(C){ie=new T(1<<D);var I=15-D;for(z=0;z<Q;++z)if(S[z])for(var m=z<<4|S[z],F=D-S[z],L=M[S[z]-1]++<<F,O=L|(1<<F)-1;L<=O;++L)ie[l[L]>>>I]=m}else for(ie=new T(Q),z=0;z<Q;++z)S[z]&&(ie[z]=l[M[S[z]-1]++]>>>15-S[z]);return ie},g=new i(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var p=new i(32);for(c=0;c<32;++c)p[c]=5;var h=U(g,9,1),y=U(p,5,1),d=function(S){for(var D=S[0],C=1;C<S.length;++C)S[C]>D&&(D=S[C]);return D},b=function(S,D,C){var Q=D/8|0;return(S[Q]|S[Q+1]<<8)>>(7&D)&C},w=function(S,D){var C=D/8|0;return(S[C]|S[C+1]<<8|S[C+2]<<16)>>(7&D)},A=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],x=function(S,D,C){var Q=new Error(D||A[S]);if(Q.code=S,Error.captureStackTrace&&Error.captureStackTrace(Q,x),!C)throw Q;return Q},N=function(S,D,C){var Q=S.length;if(!Q||C&&!C.l&&Q<5)return D||new i(0);var z=!D||C,oe=!C||C.i;C||(C={}),D||(D=new i(3*Q));var ie,M=function(ne){var _e=D.length;if(ne>_e){var ge=new i(Math.max(2*_e,ne));ge.set(D),D=ge}},I=C.f||0,m=C.p||0,F=C.b||0,L=C.l,O=C.d,E=C.m,R=C.n,k=8*Q;do{if(!L){C.f=I=b(S,m,1);var P=b(S,m+1,3);if(m+=3,!P){var V=S[(J=((ie=m)/8|0)+(7&ie&&1)+4)-4]|S[J-3]<<8,ae=J+V;if(ae>Q){oe&&x(0);break}z&&M(F+V),D.set(S.subarray(J,ae),F),C.b=F+=V,C.p=m=8*ae;continue}if(P==1)L=h,O=y,E=9,R=5;else if(P==2){var j=b(S,m,31)+257,W=b(S,m+10,15)+4,ve=j+b(S,m+5,31)+1;m+=14;for(var ue=new i(ve),q=new i(19),te=0;te<W;++te)q[o[te]]=b(S,m+3*te,7);m+=3*W;var le=d(q),G=(1<<le)-1,re=U(q,le,1);for(te=0;te<ve;){var J,B=re[b(S,m,G)];if(m+=15&B,(J=B>>>4)<16)ue[te++]=J;else{var he=0,K=0;for(J==16?(K=3+b(S,m,3),m+=2,he=ue[te-1]):J==17?(K=3+b(S,m,7),m+=3):J==18&&(K=11+b(S,m,127),m+=7);K--;)ue[te++]=he}}var $=ue.subarray(0,j),Y=ue.subarray(j);E=d($),R=d(Y),L=U($,E,1),O=U(Y,R,1)}else x(1);if(m>k){oe&&x(0);break}}z&&M(F+131072);for(var ce=(1<<E)-1,de=(1<<R)-1,X=m;;X=m){var se=(he=L[w(S,m)&ce])>>>4;if((m+=15&he)>k){oe&&x(0);break}if(he||x(2),se<256)D[F++]=se;else{if(se==256){X=m,L=null;break}var pe=se-254;if(se>264){var ye=r[te=se-257];pe=b(S,m,(1<<ye)-1)+n[te],m+=ye}var Te=O[w(S,m)&de],xe=Te>>>4;if(Te||x(3),m+=15&Te,Y=f[xe],xe>3&&(ye=e[xe],Y+=w(S,m)&(1<<ye)-1,m+=ye),m>k){oe&&x(0);break}z&&M(F+131072);for(var fe=F+pe;F<fe;F+=4)D[F]=D[F-Y],D[F+1]=D[F+1-Y],D[F+2]=D[F+2-Y],D[F+3]=D[F+3-Y];F=fe}}C.l=L,C.p=X,C.b=F,L&&(I=1,C.m=E,C.d=O,C.n=R)}while(!I);return F==D.length?D:function(ne,_e,ge){(_e==null||_e<0)&&(_e=0),(ge==null||ge>ne.length)&&(ge=ne.length);var Pe=new(ne instanceof T?T:ne instanceof v?v:i)(ge-_e);return Pe.set(ne.subarray(_e,ge)),Pe}(D,0,F)},Z=new i(0),H=typeof TextDecoder!="undefined"&&new TextDecoder;try{H.decode(Z,{stream:!0})}catch{}return u.convert_streams=function(S){var D=new DataView(S),C=0;function Q(){var j=D.getUint16(C);return C+=2,j}function z(){var j=D.getUint32(C);return C+=4,j}function oe(j){V.setUint16(ae,j),ae+=2}function ie(j){V.setUint32(ae,j),ae+=4}for(var M={signature:z(),flavor:z(),length:z(),numTables:Q(),reserved:Q(),totalSfntSize:z(),majorVersion:Q(),minorVersion:Q(),metaOffset:z(),metaLength:z(),metaOrigLength:z(),privOffset:z(),privLength:z()},I=0;Math.pow(2,I)<=M.numTables;)I++;I--;for(var m=16*Math.pow(2,I),F=16*M.numTables-m,L=12,O=[],E=0;E<M.numTables;E++)O.push({tag:z(),offset:z(),compLength:z(),origLength:z(),origChecksum:z()}),L+=16;var R,k=new Uint8Array(12+16*O.length+O.reduce(function(j,W){return j+W.origLength+4},0)),P=k.buffer,V=new DataView(P),ae=0;return ie(M.flavor),oe(M.numTables),oe(m),oe(I),oe(F),O.forEach(function(j){ie(j.tag),ie(j.origChecksum),ie(L),ie(j.origLength),j.outOffset=L,(L+=j.origLength)%4!=0&&(L+=4-L%4)}),O.forEach(function(j){var W,ve=S.slice(j.offset,j.offset+j.compLength);if(j.compLength!=j.origLength){var ue=new Uint8Array(j.origLength);W=new Uint8Array(ve,2),N(W,ue)}else ue=new Uint8Array(ve);k.set(ue,j.outOffset);var q=0;(L=j.outOffset+j.origLength)%4!=0&&(q=4-L%4),k.set(new Uint8Array(q).buffer,j.outOffset+j.origLength),R=L+q}),P.slice(0,R)},Object.defineProperty(u,"__esModule",{value:!0}),u}({}).convert_streams}function $n(u,i){const T={M:2,L:2,Q:4,C:6,Z:0},v={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,e=2,o=4,a=8,t=16,n=32;let s;function f(d){if(!s){const b={R:e,L:r,D:o,C:t,U:n,T:a};s=new Map;for(let w in v){let A=0;v[w].split(",").forEach(x=>{let[N,Z]=x.split("+");N=parseInt(N,36),Z=Z?parseInt(Z,36):0,s.set(A+=N,b[w]);for(let H=Z;H--;)s.set(++A,b[w])})}}return s.get(d)||n}const l=1,c=2,_=3,U=4,g=[null,"isol","init","fina","medi"];function p(d){const b=new Uint8Array(d.length);let w=n,A=l,x=-1;for(let N=0;N<d.length;N++){const Z=d.codePointAt(N);let H=f(Z)|0,S=l;H&a||(w&(r|o|t)?H&(e|o|t)?(S=_,(A===l||A===_)&&b[x]++):H&(r|n)&&(A===c||A===U)&&b[x]--:w&(e|n)&&(A===c||A===U)&&b[x]--,A=b[N]=S,w=H,x=N,Z>65535&&N++)}return b}function h(d,b){const w=[];for(let x=0;x<b.length;x++){const N=b.codePointAt(x);N>65535&&x++,w.push(u.U.codeToGlyph(d,N))}const A=d.GSUB;if(A){const{lookupList:x,featureList:N}=A;let Z;const H=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,S=[];N.forEach(D=>{if(H.test(D.tag))for(let C=0;C<D.tab.length;C++){if(S[D.tab[C]])continue;S[D.tab[C]]=!0;const Q=x[D.tab[C]],z=/^(isol|init|fina|medi)$/.test(D.tag);z&&!Z&&(Z=p(b));for(let oe=0;oe<w.length;oe++)(!Z||!z||g[Z[oe]]===D.tag)&&u.U._applySubs(w,oe,Q,x)}})}return w}function y(d){const b=Object.create(null),w={unitsPerEm:d.head.unitsPerEm,ascender:d.hhea.ascender,descender:d.hhea.descender,forEachGlyph(A,x,N,Z){let H=0;const S=1/w.unitsPerEm*x,D=h(d,A);let C=0,Q=-1;return D.forEach((z,oe)=>{if(z!==-1){let ie=b[z];if(!ie){const{cmds:M,crds:I}=u.U.glyphToPath(d,z);let m="",F=0;for(let k=0,P=M.length;k<P;k++){const V=T[M[k]];m+=M[k];for(let ae=1;ae<=V;ae++)m+=(ae>1?",":"")+I[F++]}let L,O,E,R;if(I.length){L=O=1/0,E=R=-1/0;for(let k=0,P=I.length;k<P;k+=2){let V=I[k],ae=I[k+1];V<L&&(L=V),ae<O&&(O=ae),V>E&&(E=V),ae>R&&(R=ae)}}else L=E=O=R=0;ie=b[z]={index:z,advanceWidth:d.hmtx.aWidth[z],xMin:L,yMin:O,xMax:E,yMax:R,path:m,pathCommandCount:M.length}}Q!==-1&&(H+=u.U.getPairAdjustment(d,Q,z)*S),Z.call(null,ie,H,C),ie.advanceWidth&&(H+=ie.advanceWidth*S),N&&(H+=N*x),Q=z}C+=A.codePointAt(C)>65535?2:1}),H}};return w}return function(b){const w=new Uint8Array(b,0,4),A=u._bin.readASCII(w,0,4);if(A==="wOFF")b=i(b);else if(A==="wOF2")throw new Error("woff2 fonts not supported");return y(u.parse(b)[0])}}const ea=ar({name:"Typr Font Parser",dependencies:[Zn,qn,$n],init(u,i,T){const v=u(),r=i();return T(v,r)}}),nr={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ra=new vt;function tr(){return(self.performance||Date).now()}const Ht=Object.create(null);function $t(u,i){u=aa({},u);const T=tr();if(u.font=oa(u.font||nr.defaultFontURL),u.text=""+u.text,u.sdfGlyphSize=u.sdfGlyphSize||nr.sdfGlyphSize,u.colorRanges!=null){let f={};for(let l in u.colorRanges)if(u.colorRanges.hasOwnProperty(l)){let c=u.colorRanges[l];typeof c!="number"&&(c=ra.set(c).getHex()),f[l]=c}u.colorRanges=f}Object.freeze(u);const{textureWidth:v,sdfExponent:r}=nr,{sdfGlyphSize:e}=u,o=v/e*4;let a=Ht[e];if(!a){const f=document.createElement("canvas");f.width=v,f.height=e*256/o,a=Ht[e]={glyphCount:0,sdfGlyphSize:e,sdfCanvas:f,sdfTexture:new yn(f,void 0,void 0,void 0,Rt,Rt),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,ta(a)}const{sdfTexture:t,sdfCanvas:n}=a;let s=a.glyphsByFont.get(u.font);s||a.glyphsByFont.set(u.font,s=new Map),sa(u).then(f=>{const{glyphIds:l,glyphPositions:c,fontSize:_,unitsPerEm:U,timings:g}=f,p=[],h=new Float32Array(l.length*4),y=_/U;let d=0,b=0;const w=tr();l.forEach((H,S)=>{let D=s.get(H);if(!D){const{path:oe,pathBounds:ie}=f.glyphData[H],M=Math.max(ie[2]-ie[0],ie[3]-ie[1])/e*(nr.sdfMargin*e+.5),I=a.glyphCount++,m=[ie[0]-M,ie[1]-M,ie[2]+M,ie[3]+M];s.set(H,D={path:oe,atlasIndex:I,sdfViewBox:m}),p.push(D)}const{sdfViewBox:C}=D,Q=c[b++],z=c[b++];h[d++]=Q+C[0]*y,h[d++]=z+C[1]*y,h[d++]=Q+C[2]*y,h[d++]=z+C[3]*y,l[S]=D.atlasIndex}),g.quads=(g.quads||0)+(tr()-w);const A=tr();g.sdf={};const x=n.height,N=Math.ceil(a.glyphCount/o),Z=Math.pow(2,Math.ceil(Math.log2(N*e)));Z>x&&(console.info(`Increasing SDF texture size ${x}->${Z}`),Qn(n,v,Z),t.dispose()),ze.all(p.map(H=>en(H,a,u.gpuAccelerateSDF).then(({timing:S})=>{g.sdf[H.atlasIndex]=S}))).then(()=>{p.length&&!a.contextLost&&(rn(a),t.needsUpdate=!0),g.sdfTotal=tr()-A,g.total=tr()-T,i(Object.freeze({parameters:u,sdfTexture:t,sdfGlyphSize:e,sdfExponent:r,glyphBounds:h,glyphAtlasIndices:l,glyphColors:f.glyphColors,caretPositions:f.caretPositions,caretHeight:f.caretHeight,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings,get totalBounds(){return console.log("totalBounds deprecated, use blockBounds instead"),f.blockBounds},get totalBlockSize(){console.log("totalBlockSize deprecated, use blockBounds instead");const[H,S,D,C]=f.blockBounds;return[D-H,C-S]}}))})}),ze.all([]).then(()=>{a.contextLost||Kn(n)})}function en({path:u,atlasIndex:i,sdfViewBox:T},{sdfGlyphSize:v,sdfCanvas:r,contextLost:e},o){if(e)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:t}=nr,n=Math.max(T[2]-T[0],T[3]-T[1]),s=Math.floor(i/4),f=s%(a/v)*v,l=Math.floor(s/(a/v))*v,c=i%4;return Hn(v,v,u,T,n,t,r,f,l,c,o)}function ta(u){const i=u.sdfCanvas;i.addEventListener("webglcontextlost",T=>{console.log("Context Lost",T),T.preventDefault(),u.contextLost=!0}),i.addEventListener("webglcontextrestored",T=>{console.log("Context Restored",T),u.contextLost=!1;const v=[];u.glyphsByFont.forEach(r=>{r.forEach(e=>{v.push(en(e,u,!0))})}),ze.all(v).then(()=>{rn(u),u.sdfTexture.needsUpdate=!0})})}function na({font:u,characters:i,sdfGlyphSize:T},v){let r=Array.isArray(i)?i.join(`
`):""+i;$t({font:u,sdfGlyphSize:T,text:r},v)}function aa(u,i){for(let T in i)i.hasOwnProperty(T)&&(u[T]=i[T]);return u}let Lr;function oa(u){return Lr||(Lr=typeof document=="undefined"?{}:document.createElement("a")),Lr.href=u,Lr.href}function rn(u){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:i,sdfTexture:T}=u,{width:v,height:r}=i,e=u.sdfCanvas.getContext("webgl");let o=T.image.data;(!o||o.length!==v*r*4)&&(o=new Uint8Array(v*r*4),T.image={width:v,height:r,data:o},T.flipY=!1,T.isDataTexture=!0),e.readPixels(0,0,v,r,e.RGBA,e.UNSIGNED_BYTE,o)}}const ia=ar({name:"Typesetter",dependencies:[nr,ea,Yn,Rn],init(u,i,T,v){const{defaultFontURL:r}=u;return T(i,v(),{defaultFontURL:r})}}),sa=ar({name:"Typesetter",dependencies:[ia,Ln],init(u,i){return function(T){const v=new i;return u.typeset(T,v.resolve),v}},getTransferables(u){const i=[u.glyphPositions.buffer,u.glyphIds.buffer];return u.caretPositions&&i.push(u.caretPositions.buffer),u.glyphColors&&i.push(u.glyphColors.buffer),i}}),fa=(()=>{const u={};function i(t){let n=u[t];if(!n){const s=new ut(1,1,t,t),f=s.clone(),l=s.attributes,c=f.attributes,_=new kn,U=l.uv.count;for(let g=0;g<U;g++)c.position.array[g*3]*=-1,c.normal.array[g*3+2]*=-1;["position","normal","uv"].forEach(g=>{_.setAttribute(g,new Fn([...l[g].array,...c[g].array],l[g].itemSize))}),_.setIndex([...s.index.array,...f.index.array.map(g=>g+U)]),_.translate(.5,.5,0),n=u[t]=_}return n}const T="aTroikaGlyphBounds",v="aTroikaGlyphIndex",r="aTroikaGlyphColor";class e extends _n{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Tn,this.boundingBox=new Sn}computeBoundingSphere(){}computeBoundingBox(){}setSide(n){const s=this.getIndex().count;this.setDrawRange(n===wn?s/2:0,n===Jt?s:s/2)}set detail(n){if(n!==this._detail){this._detail=n,(typeof n!="number"||n<1)&&(n=1);let s=i(n);["position","normal","uv"].forEach(f=>{this.attributes[f]=s.attributes[f].clone()}),this.setIndex(s.getIndex().clone())}}get detail(){return this._detail}set curveRadius(n){n!==this._curveRadius&&(this._curveRadius=n,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(n,s,f,l,c){o(this,T,n,4),o(this,v,s,1),o(this,r,c,3),this._blockBounds=f,this._chunkedBounds=l,a(this,s.length),this._updateBounds()}_updateBounds(){const n=this._blockBounds;if(n){const{curveRadius:s,boundingBox:f}=this;if(s){const{PI:l,floor:c,min:_,max:U,sin:g,cos:p}=Math,h=l/2,y=l*2,d=Math.abs(s),b=n[0]/d,w=n[2]/d,A=c((b+h)/y)!==c((w+h)/y)?-d:_(g(b)*d,g(w)*d),x=c((b-h)/y)!==c((w-h)/y)?d:U(g(b)*d,g(w)*d),N=c((b+l)/y)!==c((w+l)/y)?d*2:U(d-p(b)*d,d-p(w)*d);f.min.set(A,n[1],s<0?-N:0),f.max.set(x,n[3],s<0?0:N)}else f.min.set(n[0],n[1],0),f.max.set(n[2],n[3],0);f.getBoundingSphere(this.boundingSphere)}}applyClipRect(n){let s=this.getAttribute(v).count,f=this._chunkedBounds;if(f)for(let l=f.length;l--;){s=f[l].end;let c=f[l].rect;if(c[1]<n.w&&c[3]>n.y&&c[0]<n.z&&c[2]>n.x)break}a(this,s)}}e.prototype.setAttribute||(e.prototype.setAttribute=function(t,n){return this.attributes[t]=n,this});function o(t,n,s,f){const l=t.getAttribute(n);s?l&&l.array.length===s.length?(l.array.set(s),l.needsUpdate=!0):(t.setAttribute(n,new xn(s,f)),delete t._maxInstanceCount,t.dispose()):l&&t.deleteAttribute(n)}function a(t,n){t[t.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=n}return e})(),la=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,ua=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,ca=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,ha=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function da(u){const i=dt(u,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Ir},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new It(0,0,0,0)},uTroikaClipRect:{value:new It(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Ir},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new vt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Un},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:la,vertexTransform:ua,fragmentDefs:ca,fragmentColorTransform:ha,customRewriter({vertexShader:T,fragmentShader:v}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(v)&&(v=v.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(T)||(T=T.replace(qt,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:T,fragmentShader:v}}});return i.transparent=!0,Object.defineProperties(i,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),i}const va=(()=>{const u=new gn({color:16777215,side:Jt,transparent:!0}),i=8421504,T=new mn,v=new st,r=new st,e=[],o=new st,a="+x+y";function t(p){return Array.isArray(p)?p[0]:p}let n=()=>{const p=new ft(new ut(1,1),u);return n=()=>p,p},s=()=>{const p=new ft(new ut(1,1,32,1),u);return s=()=>p,p};const f={type:"syncstart"},l={type:"synccomplete"},c=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],_=c.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class U extends ft{constructor(){const h=new fa;super(h,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=i,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=a,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(h){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(h):(this._isSyncing=!0,this.dispatchEvent(f),$t({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},y=>{this._isSyncing=!1,this._textRenderInfo=y,this.geometry.updateGlyphs(y.glyphBounds,y.glyphAtlasIndices,y.blockBounds,y.chunkedBounds,y.glyphColors);const d=this._queuedSyncs;d&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{d.forEach(b=>b&&b())})),this.dispatchEvent(l),h&&h()})))}onBeforeRender(h,y,d,b,w,A){this.sync(),w.isTroikaTextMaterial&&this._prepareForRender(w),w._hadOwnSide=w.hasOwnProperty("side"),this.geometry.setSide(w._actualSide=w.side),w.side=bn}onAfterRender(h,y,d,b,w,A){w._hadOwnSide?w.side=w._actualSide:delete w.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let h=this._derivedMaterial;const y=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=u.clone());if((!h||h.baseMaterial!==y)&&(h=this._derivedMaterial=da(y),y.addEventListener("dispose",function d(){y.removeEventListener("dispose",d),h.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let d=h._outlineMtl;return d||(d=h._outlineMtl=Object.create(h,{id:{value:h.id+.1}}),d.isTextOutlineMaterial=!0,d.depthWrite=!1,d.map=null,h.addEventListener("dispose",function b(){h.removeEventListener("dispose",b),d.dispose()})),[d,h]}else return h}set material(h){h&&h.isTroikaTextMaterial?(this._derivedMaterial=h,this._baseMaterial=h.baseMaterial):this._baseMaterial=h}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(h){this.geometry.detail=h}get curveRadius(){return this.geometry.curveRadius}set curveRadius(h){this.geometry.curveRadius=h}get customDepthMaterial(){return t(this.material).getDepthMaterial()}get customDistanceMaterial(){return t(this.material).getDistanceMaterial()}_prepareForRender(h){const y=h.isTextOutlineMaterial,d=h.uniforms,b=this.textRenderInfo;if(b){const{sdfTexture:x,blockBounds:N}=b;d.uTroikaSDFTexture.value=x,d.uTroikaSDFTextureSize.value.set(x.image.width,x.image.height),d.uTroikaSDFGlyphSize.value=b.sdfGlyphSize,d.uTroikaSDFExponent.value=b.sdfExponent,d.uTroikaTotalBounds.value.fromArray(N),d.uTroikaUseGlyphColors.value=!y&&!!b.glyphColors;let Z=0,H=0,S=0,D,C,Q,z=0,oe=0;if(y){let{outlineWidth:M,outlineOffsetX:I,outlineOffsetY:m,outlineBlur:F,outlineOpacity:L}=this;Z=this._parsePercent(M)||0,H=Math.max(0,this._parsePercent(F)||0),D=L,z=this._parsePercent(I)||0,oe=this._parsePercent(m)||0}else S=Math.max(0,this._parsePercent(this.strokeWidth)||0),S&&(Q=this.strokeColor,d.uTroikaStrokeColor.value.set(Q==null?i:Q),C=this.strokeOpacity,C==null&&(C=1)),D=this.fillOpacity;d.uTroikaDistanceOffset.value=Z,d.uTroikaPositionOffset.value.set(z,oe),d.uTroikaBlurRadius.value=H,d.uTroikaStrokeWidth.value=S,d.uTroikaStrokeOpacity.value=C,d.uTroikaFillOpacity.value=D==null?1:D,d.uTroikaCurveRadius.value=this.curveRadius||0;let ie=this.clipRect;if(ie&&Array.isArray(ie)&&ie.length===4)d.uTroikaClipRect.value.fromArray(ie);else{const M=(this.fontSize||.1)*100;d.uTroikaClipRect.value.set(N[0]-M,N[1]-M,N[2]+M,N[3]+M)}this.geometry.applyClipRect(d.uTroikaClipRect.value)}d.uTroikaSDFDebug.value=!!this.debugSDF,h.polygonOffset=!!this.depthOffset,h.polygonOffsetFactor=h.polygonOffsetUnits=this.depthOffset||0;const w=y?this.outlineColor||0:this.color;if(w==null)delete h.color;else{const x=h.hasOwnProperty("color")?h.color:h.color=new vt;(w!==x._input||typeof w=="object")&&x.set(x._input=w)}let A=this.orientation||a;if(A!==h._orientation){let x=d.uTroikaOrient.value;A=A.replace(/[^-+xyz]/g,"");let N=A!==a&&A.match(/^([-+])([xyz])([-+])([xyz])$/);if(N){let[,Z,H,S,D]=N;v.set(0,0,0)[H]=Z==="-"?1:-1,r.set(0,0,0)[D]=S==="-"?-1:1,T.lookAt(o,v.cross(r),r),x.setFromMatrix4(T)}else x.identity();h._orientation=A}}_parsePercent(h){if(typeof h=="string"){let y=h.match(/^(-?[\d.]+)%$/),d=y?parseFloat(y[1]):NaN;h=(isNaN(d)?0:d/100)*this.fontSize}return h}localPositionToTextCoords(h,y=new Ir){y.copy(h);const d=this.curveRadius;return d&&(y.x=Math.atan2(h.x,Math.abs(d)-Math.abs(h.z))*Math.abs(d)),y}worldPositionToTextCoords(h,y=new Ir){return v.copy(h),this.localPositionToTextCoords(this.worldToLocal(v),y)}raycast(h,y){const{textRenderInfo:d,curveRadius:b}=this;if(d){const w=d.blockBounds,A=b?s():n(),x=A.geometry,{position:N,uv:Z}=x.attributes;for(let H=0;H<Z.count;H++){let S=w[0]+Z.getX(H)*(w[2]-w[0]);const D=w[1]+Z.getY(H)*(w[3]-w[1]);let C=0;b&&(C=b-Math.cos(S/b)*b,S=Math.sin(S/b)*b),N.setXYZ(H,S,D,C)}x.boundingSphere=this.geometry.boundingSphere,x.boundingBox=this.geometry.boundingBox,A.matrixWorld=this.matrixWorld,A.material.side=this.material.side,e.length=0,A.raycast(h,e);for(let H=0;H<e.length;H++)e[H].object=this,y.push(e[H])}}copy(h){const y=this.geometry;return super.copy(h),this.geometry=y,_.forEach(d=>{this[d]=h[d]}),this}clone(){return new this.constructor().copy(this)}}c.forEach(p=>{const h="_private_"+p;Object.defineProperty(U.prototype,p,{get(){return this[h]},set(y){y!==this[h]&&(this[h]=y,this._needsSync=!0)}})});let g=!1;return Object.defineProperty(U.prototype,"anchor",{get(){return this._deprecated_anchor},set(p){this._deprecated_anchor=p,g||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),g=!0),Array.isArray(p)?(this.anchorX=`${(+p[0]||0)*100}%`,this.anchorY=`${(+p[1]||0)*100}%`):this.anchorX=this.anchorY=0}}),U})(),ma=Je.exports.forwardRef((t,a)=>{var n=t,{anchorX:u="center",anchorY:i="middle",font:T,children:v,characters:r,onSync:e}=n,o=Lt(n,["anchorX","anchorY","font","children","characters","onSync"]);const s=Cn(({invalidate:_})=>_),[f]=Je.exports.useState(()=>new va),[l,c]=Je.exports.useMemo(()=>{const _=[];let U="";return Je.exports.Children.forEach(v,g=>{typeof g=="string"||typeof g=="number"?U+=g:_.push(g)}),[_,U]},[v]);return Dn(()=>new Promise(_=>na({font:T,characters:r},_)),["troika-text",T,r]),Je.exports.useLayoutEffect(()=>void f.sync(()=>{s(),e&&e(f)})),Je.exports.useEffect(()=>()=>f.dispose(),[f]),Je.exports.createElement("primitive",An({object:f,ref:a,font:T,text:c,anchorX:u,anchorY:i},o),l)});export{ma as T};
